<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>我的MYSQL学习心得（17） ： 复制 | IT技术干货</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="IT技术干货 KernelHacks 最好的技术站点 技术信息 纯干货">
    <link rel="canonical" href="http://iftti.com/posts/2015/2015-06-07-87369-741661838.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">IT技术干货</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
          
        
          <a class="page-link" href="/about/">About</a>
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>我的MYSQL学习心得（17） ： 复制</h1>
    <p class="meta"><span class="time">Jun 7, 2015</span><span class="source_url"> • 来自 jobbole.com <a name="jobbole.com" href="http://blog.jobbole.com/87369/" target="_blank">[原文链接]</a></span></p>
  </header>

  <article class="post-content">
  


        <span style="display:block;margin-bottom:10px;"></span>
		<ul>
<li><a href="http://blog.jobbole.com/87315/" target="_blank">我的MYSQL学习心得（1） ：简单语法</a></li>
<li><a href="http://blog.jobbole.com/87318/" target="_blank">我的MYSQL学习心得（2） ：数据类型宽度</a></li>
<li><a href="http://blog.jobbole.com/87322/" target="_blank">我的MYSQL学习心得（3） ： 查看字段长度</a></li>
<li><a href="http://blog.jobbole.com/87324/" target="_blank">我的MYSQL学习心得（4） ： 数据类型</a></li>
<li><a href="http://blog.jobbole.com/87327/" target="_blank">我的MYSQL学习心得（5） ： 运算符</a></li>
<li><a href="http://blog.jobbole.com/87337/" target="_blank">我的MYSQL学习心得（6） ： 函数</a></li>
<li><a href="http://blog.jobbole.com/87340/" target="_blank">我的MYSQL学习心得（7） ： 查询</a></li>
<li><a href="http://blog.jobbole.com/87345/" target="_blank">我的MYSQL学习心得（8） ： 插入 更新 删除</a></li>
<li><a href="http://blog.jobbole.com/87348/" target="_blank">我的MYSQL学习心得（9） ： 索引</a></li>
<li><a href="http://blog.jobbole.com/87351/" target="_blank">我的MYSQL学习心得（10） ： 自定义存储过程和函数</a></li>
<li><a href="http://blog.jobbole.com/87353/" target="_blank">我的MYSQL学习心得（11） ： 视图</a></li>
<li><a href="http://blog.jobbole.com/87355/" target="_blank">我的MYSQL学习心得（12） ： 触发器</a></li>
<li><a href="http://blog.jobbole.com/87357/" target="_blank">我的MYSQL学习心得（13） ： 权限管理</a></li>
<li><a href="http://blog.jobbole.com/87363/" target="_blank">我的MYSQL学习心得（14） ： 备份和恢复</a></li>
<li><a href="http://blog.jobbole.com/87365/" target="_blank">我的MYSQL学习心得（15） ： 日志</a></li>
<li><a href="http://blog.jobbole.com/87367/" target="_blank">我的MYSQL学习心得（16） ： 优化</a></li>
</ul>
<p>最近把大学时候的ORACLE教程书本翻出来看，真的是感触良多</p>
<p>以前在学校的时候，每次ORACLE测验和考试都是不合格的，期末的时候靠补考才勉强过关</p>
<p>大家看到下图的封面应该知道大学教我们ORACLE课程的老师，没错，他就是李爱武老师</p>
<p>大家可能对李爱武老师不太熟悉，在ORACLE领域，大家第一时间肯定会想到“盖国强”</p>
<p>还记得前段时间某个媒体说“盖国强”是中国第一DBA，但是我在百度里面搜索“<strong>中国第一DBA</strong>”并没有出现“<strong>盖国强</strong>”三个字o(∩_∩)o</p>
<p>李爱武老师可能会有一些人认识，他写了几本数据库方面的书，以<strong>SQLSERVER</strong>和<strong>ORACLE</strong>为主</p>
<p>老师的实力是毋容置疑的，老师上课的风格是比较凶的那种，不过老师他很细心，会把ORACLE里面的知识点讲透</p>
<p>因为比较凶，所以很多时候不是很想上他的课，有时候会选择逃课，但是想不到多年后自己会做了DBA，会研究数据库</p>
<p>虽然未到教师节，但是还是要<strong>感谢</strong>李爱武老师和大学里教我计算机知识的其他老师，感谢</p>
<p>不扯了，马上开始今天的内容。。。</p>
<p>的<img alt="" src="/images/jobbole.com/e4b25982090974677afe663874ce4289.jpg"></p>
<p>这一篇主要介绍MYSQL的复制</p>
<p>MYSQL 从3.25.15版本开始提供数据库复制功能（replication）。mysql复制是指从一个mysql主服务器（MASTER）将数据</p>
<p>复制到另一台或多台mysql从服务器（SLAVE）的过程，将主数据库的DDL和DML操作通过二进制日志传到复制服务器上，</p>
<p>然后在从服务器上对这些日志重新执行，从而使从服务器的数据保持同步。</p>
<p>在mysql中，复制操作是异步进行的，slave服务器不需要持续的保持连接接收master服务器的数据</p>
<p>mysql支持一台主服务器同时向多台从服务器进行复制操作，从服务器同时可以作为其他从服务器的主服务器，如果mysql主服务器</p>
<p>访问量大，可以通过复制数据，然后在从服务器上进行查询操作，从而降低主服务器的访问压力（读写分离），同时从服务器作为</p>
<p>主服务器的备份，可以避免主服务器因为故障数据丢失的问题。</p>
<p>mysql数据库复制操作大致可以分为三个步骤</p>
<p>1主服务器将数据的改变记录到二进制日志（binlog）中。</p>
<p>2、从服务器将主服务器的binary log events复制到他的中继日志（relay log）中。</p>
<p>3、从服务器做中继日志中的事件，将数据的改变与从服务器保持同步。</p>
<p>首先，主服务器会记录二进制日志，每个事务更新完毕数据之前，主服务器将这些操作的信息记录在二进制日志里面，在事件写入</p>
<p>二进制日志完成后，主服务器 通知存储引擎提交事务。</p>
<p>SLAVE上面的I/O进程连接上MASTER，并发出日志请求，MASTER接收到来自SLAVE的I/O进程的请求后，通过负责复制的I/O进程</p>
<p>根据请求信息读取指定日志位置之后的日志信息，返回给SLAVE的I/O进程。返回信息中除了日志所包含的信息之外，还包括本次</p>
<p>返回的信息已经到MASTER端的binlog文件的名称以及binlog的位置</p>
<p>SLAVE的I/O进程接收到信息后，将接收到的日志内容依次添加到SLAVE端的relay-log文件的最末端，并将读取到的MASTER端的</p>
<p>binlog文件名和位置记录到master-Info文件中</p>
<p>SLAVE的SQL进程检测到relay-log中新增了内容后，会马上解析relay-log的内容成为在master端真实执行时候的那些可执行内容，</p>
<p>并在自身执行</p>
<p>mysql复制环境，90%以上都是一个master带一个或者多个slave的架构模式。如果master和slave压力不是太大的话，异步复制的延时一般</p>
<p>都很少。尤其是slave端的复制方式改成两个进程处理之后，更是减少了slave端的延时</p>
<blockquote>
<p><strong>提示：对于数据实时性要求不是特别严格的应用，只需要通过廉价的电脑服务器来扩展slave的数量，将读压力分散到多台slave的机器上面</strong></p>
<p><strong>即可解决数据库端的读压力瓶颈。这在很大程度上解决了目前很多中小型网站的数据库压力瓶颈问题，甚至有些大型网站也在使用类似方案解决</strong></p>
</blockquote>
<hr>
<p><strong>Windows环境下的mysql主从复制</strong></p>
<p><strong>复制前的准备工作</strong></p>
<p>在Windows环境下，如果想实现主从复制需要准备的操作环境</p>
<p>角色          ip                      端口            操作系统          mysql版本</p>
<p>master   192.168.1.100     3306           Windows7         5.5.20</p>
<p>slave      192.168.1.102     3306           Windows8         5.5.20</p>
<p>Windows环境下实现主从复制</p>
<p>准备好两台安装mysql5.6的计算机，即可实现两台mysql服务器主从复制备份操作。</p>
<p>具体操作步骤如下：</p>
<p>1、在Windows下安装好两台mysql服务器，配置好两台主机的ip地址，实现两台计算机可以网络连通</p>
<p><img alt="" src="/images/jobbole.com/e4db397c6d1c072cde94cc1586586dc0.jpg"></p>
<p><img alt="" src="/images/jobbole.com/858b47aac78eed02e6c58433b8846436.jpg"></p>
<p>2、配置master的相关配置信息，在master主机上开启binlog日志，首先，看下datadir的具体路径</p>
<pre class="brush: sql; gutter: true">show variables  LIKE '%datadir%'</pre>
<p><img alt="" src="/images/jobbole.com/9081833fb4c378b405291faf1218fb99.jpg"></p>
<p>3、此时需要打开在D:\Program Files (x86)\MySQL\MySQL Server 5.5路径下的配置文件my.ini，添加如下代码，开启binlog功能</p>
<pre class="brush: sql; gutter: true">[mysqld]
log-bin="D:/MYSQLDataBase/binlog"
expire_logs_days=10
max_binlog_size=100M</pre>
<p>提示：此事我们需要在D盘下面创建MYSQLDATABASE文件夹，binlog日志记录在该文件夹里面，该配置文件中的其他参数如下所示</p>
<p>expire_logs_days：表示二进制日志文件删除的天数</p>
<p>max_binlog_size：表示二进制日志文件最大的大小</p>
<p>4、登录mysql后，可以执行show VARIABLES LIKE ‘%log_bin%’命令来测试下log_bin是否成功开启</p>
<pre class="brush: sql; gutter: true">show VARIABLES LIKE '%log_bin%';</pre>
<p><img alt="" src="/images/jobbole.com/12ee54d964ed78650ef2b11725d2cd28.jpg"></p>
<p><img alt="" src="/images/jobbole.com/eb0ae4ce72f561ce82441d0a7899a468.jpg"></p>
<p>如果log_bin参数是ON的话，那么表示二进制日志文件已经成功开启，如果为OFF的话，那么表示二进制日志文件开启失败</p>
<p>5、在master上配置复制所需要的账户，这里创建一个repl的用户，%表示任何远程地址的repl用户都可以连接master主机</p>
<pre class="brush: sql; gutter: true">GRANT replication slave ON *.*TO repl@'%' IDENTIFIED BY '123';

flush privileges;</pre>
<p>6、在my.ini配置文件里配置master主机的相关信息</p>
<pre class="brush: sql; gutter: true">[mysqld]
log-bin="D:/MYSQLDataBase/binlog"
expire_logs_days=10
max_binlog_size=100M

server-id=1
binlog-do-db=test
binlog-ignore-db=mysql</pre>
<p>这些配置语句的含义</p>
<p>server-id：表示服务器表示id号，master和slave主机的server-id不能一样</p>
<p>binlog-do-db：表示需要复制的数据库，这里以test库为例</p>
<p>binlog-ignore-db：表示不需要复制的数据库</p>
<p>7、重启master主机上的mysql服务，然后输入show master status命令查询master主机的信息</p>
<p><img alt="" src="/images/jobbole.com/44682bf477158f259fd1b91cf337562d.jpg"></p>
<p>8、将master主机的数据备份出来，然后导入到slave主机中去，具体执行语句如下</p>
<pre class="brush: sql; gutter: true">mysqldump -u root -p -h 127.0.0.1 test &gt;D:\TEST.TXT</pre>
<p>TEST库里面的表和数据</p>
<p><img alt="" src="/images/jobbole.com/89d44fb0a3dcc9f2673068c0ff6ae9bb.jpg"></p>
<p><img alt="" src="/images/jobbole.com/843457bddd30b007604527499a35ffe9.jpg"></p>
<p>innodb_monitor表是没有数据的</p>
<p>dump出来的txt文件内容</p>
<pre class="brush: sql; gutter: true">-- MySQL dump 10.13  Distrib 5.5.20, for Win32 (x86)
--
-- Host: 127.0.0.1    Database: test
-- ------------------------------------------------------
-- Server version    5.5.20-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `book`
--

DROP TABLE IF EXISTS `book`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `book` (
  `bookid` int(11) NOT NULL,
  `bookname` varchar(255) NOT NULL,
  `authors` varchar(255) NOT NULL,
  `info` varchar(255) DEFAULT NULL,
  `comment` varchar(255) DEFAULT NULL,
  `year_publication` year(4) NOT NULL,
  KEY `year_publication` (`year_publication`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `book`
--

LOCK TABLES `book` WRITE;
/*!40000 ALTER TABLE `book` DISABLE KEYS */;
INSERT INTO `book` VALUES (12,'dajiahao','NIHAO','??','henhao',1990);
/*!40000 ALTER TABLE `book` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `innodb_monitor`
--

DROP TABLE IF EXISTS `innodb_monitor`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `innodb_monitor` (
  `a` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `innodb_monitor`
--

LOCK TABLES `innodb_monitor` WRITE;
/*!40000 ALTER TABLE `innodb_monitor` DISABLE KEYS */;
/*!40000 ALTER TABLE `innodb_monitor` ENABLE KEYS */;
UNLOCK TABLES;

/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2014-08-05 22:36:17</pre>
<p>将D:\TEST.TXT文件复制到slave机器上，然后执行如下操作</p>
<p>在命令行登录mysql，然后 USE TEST;</p>
<p>记得一定要USE TEST，切换数据库上下文，否则会报错：NO DATABASE SELECTED 的错误信息</p>
<p>然后执行source命令导入TEXT.txt文件的内容</p>
<p><img alt="" src="/images/jobbole.com/5019edc2fd2c5d675de040a2afc5207b.jpg"></p>
<p>可以看到，数据已经导入到slave上面了</p>
<p><img alt="" src="/images/jobbole.com/48218f869b7a90ec23ff7ab3a4a52967.jpg"></p>
<p>9、配置slave机器（192.168.1.102）的my.ini配置文件</p>
<p>具体配置信息如下</p>
<pre class="brush: sql; gutter: true">[mysql]

default-character-set=utf8
log_bin="C:/MYSQLLOG/binlog"
expire_logs_days=10
max_binlog_size=100M

[mysqld]
server-id=2</pre>
<p>提示：配置slave主机my.ini文件的时候，需要将server-id=2写到[mysqld]后面</p>
<p>另外如果配置文件中还有log_bin的配置，可以将他注释掉，如下所示</p>
<pre class="brush: sql; gutter: true">#Binary Logging
#log-bin
#log_bin="xxx"</pre>
<p>10、重启slave主机（192.168.1.102）的mysql服务，在slave主机（192.168.1.102）的mysql中执行如下命令</p>
<p>关闭slave服务</p>
<pre class="brush: sql; gutter: true">stop slave;</pre>
<p>11、设置slave从机实现复制相关的信息，命令如下</p>
<pre class="brush: sql; gutter: true">change master to
master_host='192.168.1.100',
master_user='repl',
master_password='123',
master_log_file='binlog。000004',
master_log_pos=107;

Command(s) completed successfully.</pre>
<p>各个参数所代表的具体含义如下：</p>
<p>master_host：表示实现复制的主机ip地址</p>
<p>master_user：表示实现复制的登录远程主机的用户</p>
<p>master_password：表示实现复制的登录远程主机的密码</p>
<p>master_log_file：表示实现复制的binlog日志文件</p>
<p>master_log_pos：表示实现复制的binlog日志文件的偏移量</p>
<p>12、继续在从机执行操作，显示slave从机的状况，如下所示</p>
<pre class="brush: sql; gutter: true">start slave;

Command(s) completed successfully.</pre>
<pre class="brush: sql; gutter: true">mysql&gt; SHOW SLAVE STATUS \G;
*************************** 1. row ***************************
               Slave_IO_State:
                  Master_Host: 192.168.1.100
                  Master_User: repl
                  Master_Port: 3306
                Connect_Retry: 60
              Master_Log_File: binlog銆?00004
          Read_Master_Log_Pos: 107
               Relay_Log_File: Steven-PC-relay-bin.000002
                Relay_Log_Pos: 4
        Relay_Master_Log_File: binlog銆?00004
             Slave_IO_Running: No
            Slave_SQL_Running: Yes
              Replicate_Do_DB:
          Replicate_Ignore_DB:
           Replicate_Do_Table:
       Replicate_Ignore_Table:
      Replicate_Wild_Do_Table:
  Replicate_Wild_Ignore_Table:
                   Last_Errno: 0
                   Last_Error:
                 Skip_Counter: 0
          Exec_Master_Log_Pos: 107
              Relay_Log_Space: 107
              Until_Condition: None
               Until_Log_File:
                Until_Log_Pos: 0
           Master_SSL_Allowed: No
           Master_SSL_CA_File:
           Master_SSL_CA_Path:
              Master_SSL_Cert:
            Master_SSL_Cipher:
               Master_SSL_Key:
        Seconds_Behind_Master: NULL
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: 1236
                Last_IO_Error: Got fatal error 1236 from master when reading dat
a from binary log: 'Could not find first log file name in binary log index file'

               Last_SQL_Errno: 0
               Last_SQL_Error:
  Replicate_Ignore_Server_Ids:
             Master_Server_Id: 1
1 row in set (0.00 sec)

ERROR:
No query specified</pre>
<p>在上述执行show slave status \G命令中很显然存在一些问题，问题如下</p>
<pre class="brush: sql; gutter: true"> Last_IO_Errno: 1236
                Last_IO_Error: Got fatal error 1236 from master when reading dat
a from binary log: 'Could not find first log file name in binary log index file'</pre>
<p>下面的步骤可以解决问题，具体步骤如下</p>
<p>1、重启master（192.168.1.100）主机的mysql服务，执行show master status \G命令</p>
<p>记下File和Position的值，后面slave主机会用到，命令执行如下</p>
<pre class="brush: sql; gutter: true">SHOW MASTER STATUS;</pre>
<p><img alt="" src="/images/jobbole.com/14c9359d96f43d8d8271858b14225031.jpg"></p>
<p>2、在slave（192.168.1.102）主机上重新设置信息，命令执行如下</p>
<pre class="brush: sql; gutter: true">stop slave;</pre>
<pre class="brush: sql; gutter: true">change master to
master_log_file='binlog.000005',
master_log_pos=107;</pre>
<pre class="brush: sql; gutter: true">start slave;</pre>
<pre class="brush: sql; gutter: true">mysql&gt; SHOW SLAVE STATUS \G;
*************************** 1. row ***************************
               Slave_IO_State: Waiting for master to send event
                  Master_Host: 192.168.1.100
                  Master_User: repl
                  Master_Port: 3306
                Connect_Retry: 60
              Master_Log_File: binlog.000005
          Read_Master_Log_Pos: 107
               Relay_Log_File: Steven-PC-relay-bin.000002
                Relay_Log_Pos: 250
        Relay_Master_Log_File: binlog.000005
             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB:
          Replicate_Ignore_DB:
           Replicate_Do_Table:
       Replicate_Ignore_Table:
      Replicate_Wild_Do_Table:
  Replicate_Wild_Ignore_Table:
                   Last_Errno: 0
                   Last_Error:
                 Skip_Counter: 0
          Exec_Master_Log_Pos: 107
              Relay_Log_Space: 410
              Until_Condition: None
               Until_Log_File:
                Until_Log_Pos: 0
           Master_SSL_Allowed: No
           Master_SSL_CA_File:
           Master_SSL_CA_Path:
              Master_SSL_Cert:
            Master_SSL_Cipher:
               Master_SSL_Key:
        Seconds_Behind_Master: 0
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: 0
                Last_IO_Error:
               Last_SQL_Errno: 0
               Last_SQL_Error:
  Replicate_Ignore_Server_Ids:
             Master_Server_Id: 1
1 row in set (0.00 sec)

ERROR:
No query specified</pre>
<p>这次正常了，实际上刚才有两个地方是错误的</p>
<p><strong>第一个</strong>：在从机的my.ini里面</p>
<pre class="brush: sql; gutter: true">[mysql]
default-character-set=utf8
#log_bin="C:/MYSQLLOG/binlog"
#expire_logs_days=10
#max_binlog_size=100M</pre>
<p>在从机的my.ini里面的mysql配置节下面配置了binlog，实际上这样做是错误的，要配置binlog需要在[mysqld]配置节下</p>
<p><strong>第二个</strong>：第一次配置从机的同步的时候本人写错了标点符号，.号写成。号</p>
<pre class="brush: sql; gutter: true">master_log_file='binlog。000004',</pre>
<p>这时候，我们可以在从机上面执行show processlist来查询从服务器的进程状态</p>
<pre class="brush: sql; gutter: true">mysql&gt; show processlist \G
*************************** 1. row ***************************
     Id: 4
   User: root
   Host: localhost:60968
     db: information_schema
Command: Sleep
   Time: 3613
  State:
   Info: NULL
*************************** 2. row ***************************
     Id: 5
   User: system user
   Host:
     db: NULL
Command: Connect
   Time: 3613
  State: Waiting for master to send event
   Info: NULL
*************************** 3. row ***************************
     Id: 6
   User: system user
   Host:
     db: NULL
Command: Connect
   Time: 2769
  State: Slave has read all relay log; waiting for the slave I/O thread to update it
   Info: NULL
*************************** 4. row ***************************
     Id: 7
   User: root
   Host: localhost:61007
     db: NULL
Command: Query
   Time: 0
  State: NULL
   Info: show processlist
4 rows in set (0.04 sec)</pre>
<p>结果表明slave已经连接上master，开始接收并执行日志</p>
<p>relay-log.info文件里面的内容</p>
<pre class="brush: sql; gutter: true">.\Steven-PC-relay-bin.000002
250
binlog.000005
107
7</pre>
<p>relay-log.info文件里面记录了slave端的relaylog的当前文件名和位置，还有master端的binlog文件名和位置</p>
<p><img alt="" src="/images/jobbole.com/336d035302a39501b689b12bc47e4cc2.jpg"></p>
<hr>
<p><strong>Windows环境下主从复制测试</strong></p>
<p>1、在master端的mysql环境下，执行下面命令</p>
<pre class="brush: sql; gutter: true">use test;
create table rep_test(data integer);

insert into rep_test values(2);</pre>
<p>2、在slave端的mysql环境下，查看主机刚才添加的表和数据是否成功同步到从机上</p>
<pre class="brush: sql; gutter: true">use test;

show tables;

select * FROM REP_TEST;</pre>
<p><img alt="" src="/images/jobbole.com/ec21cc2d0cdfded8c4f44674891b6f2f.jpg"></p>
<p><img alt="" src="/images/jobbole.com/4ab2c6589e307985d3fa2e3709641848.jpg"></p>
<p>测试表明，数据已经成功地同步到slave上，实验中只是用到了主从同步，在实际生产环境中MYSQL架构可能会用到一主多从的架构</p>
<hr>
<p><strong>MYSQL主要复制启动选项</strong></p>
<p>（1）log-slave-updates</p>
<p>log-slave-updates这个参数主要用来配置从服务器的更新是否写入二进制日志，该选项默认是不打开的，如果这个</p>
<p>从服务器同时也作为其他服务器的主服务器，搭建一个链式的复制，那么就需要开启这个选项，这样从服务器才能获取他</p>
<p>的二进制日志进行同步操作</p>
<p>（2）master-connect-retry</p>
<p>master-connect-retry这个参数用来设置和主服务器连接丢失的时候进行重试的时间间隔，默认是60秒</p>
<p>（3）read-only</p>
<p>read-only是用来限制普通用户对从数据库的更新操作，以确保从数据库的安全性，不过如果是超级用户依然可以对</p>
<p>从数据库进行更新操作。如果主数据库创建了一个普通用户，在默认情况下，该用户是可以更新从数据库的数据的，如果</p>
<p>使用read-only选项启动从数据库以后，用户对从数据库进行更新时会提示错误</p>
<p>在Linux下启动mysql例子</p>
<pre class="brush: sql; gutter: true">[root@localhost~]#mysqld_safe -read-only</pre>
<p>（4）slave-skip-errors</p>
<p>在复制过程中，从服务器可以会执行BINLOG中的错误SQL语句，此时如果不忽略错误，从服务器会停止复制进程，等待用户处理错误。</p>
<p>这种错误如果不能及时发现，将会对应用或者备份产生影响。slave-skip-errors的作用就是用来定义复制过程中从服务器可以自动</p>
<p>跳过的错误号，设置该参数后，mysql会自动跳过所配置的一系列错误，直接执行后面的SQL语句，该参数可以定义多个错误号，如果</p>
<p>设置成all，则表示跳过所有的错误，在my.ini或者my.cnf里配置如下</p>
<pre class="brush: sql; gutter: true">slave-skip-errors=1007,1051,1062</pre>
<p>如果从数据库主要作为主库的备份，那么就不应该使用这个启动参数，因为一旦设置不当很可能造成主从库的数据不同步。</p>
<p>如果从库仅仅是为了分担主库的查询压力，并且对数据的完整性要求不高，那么这个选项可以减轻DBA维护从库的工作量</p>
<hr>
<p><strong>查看slave的复制进度</strong></p>
<p>很多情况下，用户都想知道从服务器复制的进度，从而判断从服务器上复制数据的完整性，同时判断是否需要手工来做</p>
<p>主从同步工作。</p>
<p>事实上，用户可以通过show processlist列表中的Slave_SQL_Running线程的Time值得到，他记录了从服务器当前执行的SQL时间戳</p>
<p>和系统时间之间的差距，例如下面的例子</p>
<pre class="brush: sql; gutter: true">  Id: 6
   User: system user
   Host:
     db: NULL
Command: Connect
   Time: 2769
  State: Slave has read all relay log; waiting for the slave I/O thread to update it
   Info: NULL</pre>
<p>Time时间说明从服务器最后执行的更新操作大概是主服务器<strong>2769秒</strong>前的更新操作</p>
<hr>
<p><strong>日常管理和维护</strong></p>
<p>复制配置完成后，DBA需要进行日常的监控和管理维护工作，以便能够及时发现问题和解决问题</p>
<p>以保证主从数据库能够正常工作。</p>
<p>1、了解服务器的状态</p>
<p>一般使用show slave status命令来检查从服务器</p>
<p>在查看服务器信息中，首先要查看下面的两个进程是否为YES。</p>
<pre class="brush: sql; gutter: true">Slave_IO_Running: Yes
Slave_SQL_Running: Yes</pre>
<p>Slave_IO_Running表明此进程是否能够由从服务器到主服务器上正确地读取binlog日志，并写入到从服务器的中继日志中</p>
<p>Slave_SQL_Running表明此进程能否读取并执行中继日志中的binlog信息</p>
<p>2、服务器复制出错原因</p>
<p>问题一：出现“log event entry exceeded max_allowed_pack”错误</p>
<p>如果在应用中使用大的BLOB列或CLOB列或者长字符串，那么在从服务器上回复时，可能会出现</p>
<p>“log event entry exceeded max_allowed_pack”的错误，这是因为含有达文本的记录无法通过网络进行传输而导致的</p>
<p>解决方法是在主服务器和从服务器上添加max_allowed_packet参数，该参数默认设置为1MB</p>
<pre class="brush: sql; gutter: true">show variables LIKE '%max_all%'</pre>
<pre class="brush: sql; gutter: true">Variable_name      Value   
------------------ ------- 
max_allowed_packet 1048576 

(1 row(s) affected)</pre>
<pre class="brush: sql; gutter: true">set @@global.max_allowed_packet=16777216;</pre>
<p>同时在my.ini或my.cnf文件里设置max_allowed_packet=16M，数据库重启之后该参数将有效</p>
<p>问题二：多主复制时的自增长变量冲突问题</p>
<p>大多数情况下使用一台主服务器对一台或者多台从服务器，但是在某些情况下可能会存在多个服务器配置为复制主服务器，</p>
<p>使用auto_increment时应采取特殊步骤以防止键值冲突，否则插入时多个主服务器会试图使用相同的auto_increment值</p>
<p>服务器变量auto_increment_increment和auto_increment_offset可以协调多主服务器复制auto_increment列</p>
<p>在多主服务器复制到从服务器的过程中会发生主键冲突问题，可以将不同的主服务器的这两个参数重新进行设置，将A库</p>
<p>上设置auto_increment_increment=1，auto_increment_offset=1，此时B库上设置</p>
<p>auto_increment_increment=1，auto_increment_offset=0</p>
<p><strong>提示：一般不建议使用双主或多主，因为这样会带来意想不到的冲突状况，就像SQLSERVER的对等复制，虽然有很多冲突检测措施</strong></p>
<p><strong>但是有时候冲突是不可预料的，出现冲突DBA要排查，维护成本较高，我们生产环境里是没有使用双主和多主，主要使用的是一主多从或一主一从</strong></p>
<hr>
<p><strong>切换主从服务器</strong></p>
<p>在实际生产环境，如果主机上的主库发生故障，需要将从机上的从库切换成主库，同时需要修改服务器C的配置文件，使程序连接到从机</p>
<p>下面介绍主从切换的步骤</p>
<p>1、首先要确保所有的从库都已经执行了relay log中的全部更新，看从库的状态是否是Has read all relay log，是否更新都已经执行完成</p>
<p>在从库上执行下面命令</p>
<pre class="brush: sql; gutter: true">STOP SLAVE IO_THREAD;

Command(s) completed successfully.</pre>
<pre class="brush: sql; gutter: true">mysql&gt; show processlist \G
*************************** 1. row ***************************
     Id: 4
   User: root
   Host: localhost:60968
     db: test
Command: Sleep
   Time: 45
  State:
   Info: NULL
*************************** 2. row ***************************
     Id: 6
   User: system user
   Host:
     db: NULL
Command: Connect
   Time: 3949
  State: Slave has read all relay log; waiting for the slave I/O thread to update it
   Info: NULL
*************************** 3. row ***************************
     Id: 7
   User: root
   Host: localhost:61007
     db: NULL
Command: Query
   Time: 0
  State: NULL
   Info: show processlist
3 rows in set (0.00 sec)</pre>
<p>2、在从库上停止slave服务，然后执行reset master重置成为主库</p>
<pre class="brush: sql; gutter: true">STOP SLAVE;

Command(s) completed successfully.

RESET MASTER;
Command(s) completed successfully.</pre>
<p>注意：如果从库上并未开binlog，那么在执行reset master的时候会报错：ERROR 1186(HY000):BINLOG CLOSED ,CANNOT RESET MASTER</p>
<p>在切换之后，在从库的数据目录会多出master.info文件</p>
<p>master.info文件里的内容</p>
<pre class="brush: sql; gutter: true">18
binlog.000005
393
192.168.1.100
repl
123
3306
60
0

0
1800.000

0
0</pre>
<p>基本上记录了主库的复制用户、密码和binlog文件名和位置等</p>
<p>3、在从库B（192.168.1.102）上添加具有replication权限的用户repl，查询主库状态，命令如下</p>
<pre class="brush: sql; gutter: true">GRANT REPLICATION SLAVE ON *.*TO 'repl'@'localhost' identified by '123';

show master status;</pre>
<p><img alt="" src="/images/jobbole.com/c2edd2bb5dab902ce5e281324941792d.jpg"></p>
<p>4、修改主服务器的my.ini文件里的server-id为1，从服务器的server-id为2</p>
<p>5、在原来的主库（192.168.1.100）上配置复制参数</p>
<pre class="brush: sql; gutter: true">change master TO
master_host='192.168.1.102',
master_user='repl',
master_password='123',
master_port=3306,
master_log_file='on.000004',
master_log_pos=107;</pre>
<p>6、在从库（192.168.1.100）上执行show slave status命令查看从库是否启动成功</p>
<pre class="brush: sql; gutter: true">START SLAVE;</pre>
<pre class="brush: sql; gutter: true">mysql&gt; show slave status \G;
*************************** 1. row ***************************
               Slave_IO_State: Waiting for master to send event
                  Master_Host: 192.168.1.102
                  Master_User: repl
                  Master_Port: 3306
                Connect_Retry: 60
              Master_Log_File: on.000004
          Read_Master_Log_Pos: 107
               Relay_Log_File: joe-relay-bin.000006
                Relay_Log_Pos: 246
        Relay_Master_Log_File: on.000004
             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB:
          Replicate_Ignore_DB:
           Replicate_Do_Table:
       Replicate_Ignore_Table:
      Replicate_Wild_Do_Table:
  Replicate_Wild_Ignore_Table:
                   Last_Errno: 0
                   Last_Error:
                 Skip_Counter: 0
          Exec_Master_Log_Pos: 107
              Relay_Log_Space: 436
              Until_Condition: None
               Until_Log_File:
                Until_Log_Pos: 0
           Master_SSL_Allowed: No
           Master_SSL_CA_File:
           Master_SSL_CA_Path:
              Master_SSL_Cert:
            Master_SSL_Cipher:
               Master_SSL_Key:
        Seconds_Behind_Master: 0
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: 0
                Last_IO_Error:
               Last_SQL_Errno: 0
               Last_SQL_Error:
  Replicate_Ignore_Server_Ids:
             Master_Server_Id: 1
1 row in set (0.00 sec)

ERROR:
No query specified</pre>
<p>注意：如果在主库上面（192.168.1.102）的复制用户repl没有允许远程主机从库的访问，那么在执行show slave status的时候就会报错</p>
<pre class="brush: sql; gutter: true"> Last_IO_Errno: 1130
 Last_IO_Error: error connecting to master 'repl@192.168.1.102:3360  retries: 8640006' - retry-time: 60  retries: 86400</pre>
<p>这时候，只需要在主库（192.168.1.102）上面执行下面语句即可</p>
<pre class="brush: sql; gutter: true">use mysql;
select * from user where user='repl';
update user set host = '%' where user ='repl';
flush privileges;</pre>
<p>7、在主库和从库上面是否成功设置复制功能，首先在主库（192.168.1.102）上查看test库中的表</p>
<pre class="brush: sql; gutter: true">use test;
show tables;</pre>
<p><img alt="" src="/images/jobbole.com/5c52f32d39bd879d054b01f883bb08a9.jpg"></p>
<p>查询从库中（192.168.1.100）test库里表的情况</p>
<pre class="brush: sql; gutter: true">use test;
show tables;</pre>
<p><img alt="" src="/images/jobbole.com/14304fa0cadf5b3d09329b4007746de6.jpg"></p>
<p>跟主库一样</p>
<p>8、在主库（192.168.1.102）中增加表rep_t ，并插入数据</p>
<pre class="brush: sql; gutter: true">create table rep_t(data int);

insert into rep_t values(1);</pre>
<p>9、在从库（192.168.1.100）上查询表是否已经创建并复制数据到从库中</p>
<pre class="brush: sql; gutter: true">USE test;

show variables like '%server%';

show tables;

SELECT * FROM rep_t;</pre>
<p><img alt="" src="/images/jobbole.com/65d6d02c9a49d674feb79e594563629e.jpg"></p>
<p>至此，主从库成功切换</p>
<hr>
<p><strong>如果主机和从机server-id一样如何解决</strong></p>
<p>通常情况下，master和slave的server-id是不会一样的，如果一样的话会出现报错</p>
<p>出现这种情况，用户可以使用如下命令来查看服务器的server-id，然后手动进行修改，如下所示</p>
<pre class="brush: sql; gutter: true">show variables like '%server_id%';

Variable_name Value 
------------- ----- 
server_id     2     

(1 row(s) affected)</pre>
<pre class="brush: sql; gutter: true">SET global server_id=1</pre>
<p>修改完成后，执行slave start命令，查询slave主机的状态，查看问题可否解决</p>
<hr>
<p><strong>从机状态显示Last_IO_Error错误代码为2013的原因</strong></p>
<p>有时候会遇到这样的情况，在执行show slave status \G 命令中 Slave_IO_Running和Slave_SQL_Running的值都是YES</p>
<p>但是Last_IO_Error发生2013错误</p>
<p>发生这种问题主要原因是网络问题，首先要检查下master主机创建的用户是否授予远程连接的权限</p>
<pre class="brush: sql; gutter: true">GRANT replication slave ON *.*TO repl@'%' IDENTIFIED BY '123';</pre>
<p>这里%表示任何的repl用户都可以访问master主机，另外需要查看是否有防火墙设置和网络的其他故障</p>
<hr>
<p><strong>MYSQL复制不同步的原因</strong></p>
<p>mysql replication（复制）采用binlog进行网络传输，所以网络延时是产生mysql主从不同步的主要原因，这会给我们进行读写分离带来</p>
<p>一定困难</p>
<p>为了避免这种情况，在配置服务器的时候推荐使用INNODB存储引擎的表，在主机上可以设置<strong>sync_binlog</strong></p>
<p>下面内容摘抄自《MYSQL行调优和架构设计》</p>
<blockquote>
<p>“sync_binlog”：这个参数是对于 MySQL 系统来说是至关重要的，他不仅影响到 Binlog 对 MySQL 所</p>
<p>带来的性能损耗，而且还影响到 MySQL 中数据的完整性。对于“sync_binlog”参数的各种设置的说明如</p>
<p>下：</p>
<p>● sync_binlog=0，当事务提交之后，MySQL 不做 fsync 之类的磁盘同步指令刷新 binlog_cache 中</p>
<p>的信息到磁盘，而让 Filesystem 自行决定什么时候来做同步，或者 cache 满了之后才同步到磁</p>
<p>盘。</p>
<p>● sync_binlog=n，当每进行 n 次事务提交之后，MySQL 将进行一次 fsync 之类的磁盘同步指令来</p>
<p>将 binlog_cache 中的数据强制写入磁盘。</p>
<p>在 MySQL 中系统默认的设置是 sync_binlog=0，也就是不做任何强制性的磁盘刷新指令，这时候的性</p>
<p>能是最好的，但是风险也是最大的。因为一旦系统 Crash，在 binlog_cache 中的所有 binlog 信息都会被</p>
<p>丢失。而当设置为“1”的时候，是最安全但是性能损耗最大的设置。因为当设置为 1 的时候，即使系统</p>
<p>Crash，也最多丢失 binlog_cache 中未完成的一个事务，对实际数据没有任何实质性影响。从以往经验</p>
<p>和相关测试来看，对于高并发事务的系统来说，“sync_binlog”设置为 0 和设置为 1 的系统写入性能差</p>
</blockquote>
<p>如果master主机上的max_allowed_packet比较大，但是从机上没有配置该值的话，该参数还是使用默认值1MB</p>
<p>此时很有可能导致同步失败，建议主从两台机器都设为5MB比较合适</p>
<hr>
<p><strong>总结</strong></p>
<p>本文简单的阐述了MYSQL的复制方面的内容，MYSQL复制是比较重要的技术</p>
<p>文本的主从切换使用手工的方式，当然在真实生产环境一般使用<strong>自动切换脚本</strong>和<strong>软件工具</strong>去做自动主从切换，这里不做介绍了</p>
<p>希望这篇文章对大家有帮助</p>

        
        
    <div class="post-adds">
        <span data-post-id="87369" class="btn-bluet href-style vote-post-up   register-user-only "><i class="fa  fa-thumbs-o-up"></i> <h10 id="87369votetotal">1</h10> 赞</span>
        <span data-book-type="1" data-site-id="2" data-item-id="87369" data-item-type="1" class="btn-bluet href-style bookmark-btn  register-user-only "><i class="fa fa-bookmark-o  "></i> 1 收藏</span>

                <a href="#article-comment"><span class="btn-bluet href-style"><i class="fa fa-comments-o"></i>  评论</span></a>
        
            </div>


        <!-- BEGIN #author-bio -->


<!-- END #author-bio -->
	


  </article>

  <div class="meta">
  
    <a class="basic-alignment left" href="/posts/2015/2015-06-07-87367-302bea242.html" title="Previous Post: 我的MYSQL学习心得（16） ： 优化" data-instant>&laquo; 我的MYSQL学习心得（16） ： 优化</a>
  
  
    <a class="basic-alignment right" href="/posts/2015/2015-06-07-git-rebase.html-26805a866.html" title="Next Post: Git Rebase" data-instant>Git Rebase &raquo;</a>
  
</div>
  <div id="related">
  <h2 class="subheader">Related Posts <small>They might be useful</small></h2>
  <ul class="posts">
    
      <li><span>14 May 2018</span> &raquo; <a href="http://iftti.com/posts/2018/2018-05-14-113985-6dc6e9281.html">给初学者看的 shuf 命令教程</a></li>
    
      <li><span>13 May 2018</span> &raquo; <a href="http://iftti.com/posts/2018/2018-05-13-113977-b56537dc0.html">常用排序算法总结（2）</a></li>
    
      <li><span>13 May 2018</span> &raquo; <a href="http://iftti.com/posts/2018/2018-05-13-113953-957e4ea5a.html">10 个常用的软件架构模式</a></li>
    
  </ul>
</div>

  
<comments>

<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1936498"></script>
<!-- UY END -->

</comments>

</div>
      <!-- JiaThis Button BEGIN -->
<div class="jiathis_share_slide jiathis_share_24x24" id="jiathis_share_slide">
<div class="jiathis_share_slide_top" id="jiathis_share_title"></div>
<div class="jiathis_share_slide_inner">
<div class="jiathis_style_24x24">
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_googleplus"></a>
<a class="jiathis_button_twitter"></a>
<a class="jiathis_button_linkedin"></a>
<a class="jiathis_button_weixin"></a>
<a class="jiathis_button_cqq"></a>
<a class="jiathis_button_renren"></a>
<a class="jiathis_button_evernote"></a>
<a class="jiathis_button_pocket"></a>
<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'
	,slide:{
		divid:'wrap',
		pos:'left',
		gt:'true'
	}
};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1936498" charset="utf-8"></script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_slide.js" charset="utf-8"></script>
</div></div></div>
<!-- JiaThis Button END -->
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">IT技术干货</h2>

    <div class="footer-col-1 column">
      <p class="text">IT技术干货 KernelHacks 最好的技术站点 技术信息 纯干货</p>
      <ul>
        <li>汇集最好的科技与互联网信息</li>
        <li>Liu Lantao</li>
        <li><a href="mailto:iftti@iftti.com">iftti@iftti.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/Lax">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">Lax</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/liulantao">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">@liulantao</span>
          </a>
        </li>
        <li>
          <a href="https://plus.google.com/+LiuLantao">
            <span class="icon googleplus">
              <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                width="16px" height="16px" viewBox="0 0 134.658 131.646" enable-background="new 0 0 134.658 131.646"
                xml:space="preserve">
                <g>
                  <path fill="#C2C2C2" d="M126.515,4.109H8.144c-2.177,0-3.94,1.763-3.94,3.938v115.546c0,2.179,1.763,3.942,3.94,3.942h118.371
                  c2.177,0,3.94-1.764,3.94-3.942V8.048C130.455,5.872,128.691,4.109,126.515,4.109z"/>
                  <g>
                    <path fill="#FFFFFF" d="M70.479,71.845l-3.983-3.093c-1.213-1.006-2.872-2.334-2.872-4.765c0-2.441,1.659-3.993,3.099-5.43
                    c4.64-3.652,9.276-7.539,9.276-15.73c0-8.423-5.3-12.854-7.84-14.956h6.849l7.189-4.517H60.418
                    c-5.976,0-14.588,1.414-20.893,6.619c-4.752,4.1-7.07,9.753-7.07,14.842c0,8.639,6.633,17.396,18.346,17.396
                    c1.106,0,2.316-0.109,3.534-0.222c-0.547,1.331-1.1,2.439-1.1,4.32c0,3.431,1.763,5.535,3.317,7.528
                    c-4.977,0.342-14.268,0.893-21.117,5.103c-6.523,3.879-8.508,9.525-8.508,13.51c0,8.202,7.731,15.842,23.762,15.842
                    c19.01,0,29.074-10.519,29.074-20.932C79.764,79.709,75.344,75.943,70.479,71.845z M56,59.107
                    c-9.51,0-13.818-12.294-13.818-19.712c0-2.888,0.547-5.87,2.428-8.199c1.773-2.218,4.861-3.657,7.744-3.657
                    c9.168,0,13.923,12.404,13.923,20.382c0,1.996-0.22,5.533-2.762,8.09C61.737,57.785,58.762,59.107,56,59.107z M56.109,103.65
                    c-11.826,0-19.452-5.657-19.452-13.523c0-7.864,7.071-10.524,9.504-11.405c4.64-1.561,10.611-1.779,11.607-1.779
                    c1.105,0,1.658,0,2.538,0.111c8.407,5.983,12.056,8.965,12.056,14.629C72.362,98.542,66.723,103.65,56.109,103.65z"/>
                    <polygon fill="#FFFFFF" points="98.393,58.938 98.393,47.863 92.923,47.863 92.923,58.938 81.866,58.938 81.866,64.469
                    92.923,64.469 92.923,75.612 98.393,75.612 98.393,64.469 109.506,64.469 109.506,58.938"/>
                  </g>
                </g>
              </svg>
            </span>
            <span class="username">+LiuLantao</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">
      
<!--以下是QQ邮件列表订阅嵌入代码--><script >var nId = "6be92ef3590ee662cd5e6381ab2044c328716364f684cf3e",nWidth="auto",sColor="light",sText="填写您的邮件地址，订阅我们的精彩内容：" ;</script><script src="http://list.qq.com/zh_CN/htmledition/js/qf/page/qfcode.js" charset="gb18030"></script>

    </div>

  </div>

  <div class="wrap">
    <div>
      <a href="http://blog.liulantao.com">Blog</a> | <a href="http://1000bit.com">铅笔特评 1000bit</a> | <a href="http://visplanet.com">VisPlanet</a> | <a href="http://iftti.com">IT技术干货</a> | <a href="http://relax.org.cn">Relax</a> | <a href="http://hangzhou.io">杭州城市指南</a>
    </div>
  </div>

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1658815-7', 'iftti.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>


</footer>


    </body>
</html>