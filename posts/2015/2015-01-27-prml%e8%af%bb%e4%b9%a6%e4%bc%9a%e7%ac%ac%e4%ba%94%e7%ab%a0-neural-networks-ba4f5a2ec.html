<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>PRML读书会第五章  Neural Networks | IT技术干货</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="IT技术干货 KernelHacks 最好的技术站点 技术信息 纯干货">
    <link rel="canonical" href="http://iftti.com/posts/2015/2015-01-27-prml%25e8%25af%25bb%25e4%25b9%25a6%25e4%25bc%259a%25e7%25ac%25ac%25e4%25ba%2594%25e7%25ab%25a0-neural-networks-ba4f5a2ec.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

</head>

    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">IT技术干货</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">

          <a class="page-link" href="/about/">About</a>

      </div>
    </nav>

  </div>

</header>

    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>PRML读书会第五章  Neural Networks</h1>
    <p class="meta"><span class="time">Jan 27, 2015</span><span class="source_url"> • 来自 52nlp.cn <a name="52nlp.cn" href="http://www.52nlp.cn/prml%e8%af%bb%e4%b9%a6%e4%bc%9a%e7%ac%ac%e4%ba%94%e7%ab%a0-neural-networks" target="_blank">[原文链接]</a></span></p>
  </header>

  <article class="post-content">

						<p style="text-align: center"><strong>PRML</strong><strong>读书会第五章 Neural Networks</strong></p>
<p style="text-align: center"><strong>主讲人 网神</strong></p>
<p style="text-align: center"><strong>（新浪微博:<a href="http://weibo.com/ghtimaq">@豆角茄子麻酱凉面</a>）</strong></p>
<p>网神(66707180) 18:55:06</p>
<p>那我们开始了啊，前面第3,4章讲了回归和分类问题，他们应用的主要限制是维度灾难问题。今天的第5章神经网络的内容：<br>
1. 神经网络的定义<br>
2. 训练方法：error函数，梯度下降，后向传导<br>
3. 正则化：几种主要方法，重点讲卷积网络</p>
<p>书上提到的这些内容今天先不讲了，以后有时间再讲：BP在Jacobian和Hessian矩阵中求导的应用；<br>
混合密度网络；贝叶斯解释神经网络。</p>
<p>首先是神经网络的定义，先看一个最简单的神经网络，只有一个神经元：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-0.png"><img class="aligncenter wp-image-7237" src="/images/52nlp.cn/5f5d8a997f06dc1f5c2179b2ab219ddf.jpg" alt="prml5-0" width="400" height="179"></a></p>
<p>这个神经元是一个以x1,x2,x3和截距1为输入的运算单元，其输出是：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-1.png"><img class="aligncenter wp-image-7238" src="/images/52nlp.cn/01e9dc088a9e751f673279fe3aecde5f.jpg" alt="prml5-1" width="350" height="22"></a></p>
<p>其中函数f成为”激活函数” , activation function.激活函数根据实际应用确定，经常选择sigmoid函数.如果是sigmoid函数，这个神经元的输入-输出的映射就是一个logistic回归问题。</p>
<p><span id="more-7236"></span></p>
<p>神经网络就是将许多个神经元连接在一起组成的网络，如图：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-2.png"><img class="aligncenter wp-image-7239" src="/images/52nlp.cn/69eca26b0c0bdc05eeedf171565501c1.jpg" alt="prml5-2" width="400" height="361"></a></p>
<p>神经网络的图跟后面第八章图模型不同， 图模型中，每个节点都是一个随机变量，符合某个分布。神经网络中的节点是确定的值，由与其相连的节点唯一确定。</p>
<p>上图这个神经网络包含三层，左边是输入层，x1…xd节点是输入节点， x0是截距项。最右边是输出层，y1,…,yk是输出节点. 中间是隐藏层hidden level, z1,…,zM是隐藏节点，因为不能从训练样本中观察到他们的值，所以叫隐藏层。</p>
<p>可以把神经网络描述为一系列的函数转换。首先，构造M个输入节点的线性组合：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-5.png"><img class="aligncenter wp-image-7240" src="/images/52nlp.cn/0b61129441c5ff88b94bbabf5821d43f.jpg" alt="prml5-5" width="200" height="59"></a></p>
<p>上式中，j=1,…,M，对应M个隐藏节点. 上标(1)表示这是第一层的参数。wji是权重weight,wj0是偏置.  aj 叫做activation. 中文叫激活吧，感觉有点别扭。</p>
<p>把activation aj输入到一个非线性激活函数h(.) <a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-6.png"><img class="alignnone wp-image-7241" src="/images/52nlp.cn/d602aff92ee5efe3f71eaacda1c36c75.jpg" alt="prml5-6" width="78" height="20"></a>就得到了隐藏节点的值zj。</p>
<p>在这个从输入层到隐藏层的转换中，这个激活函数不能是线性的，接下来，将隐藏节点的值线性组合得到输出节点的activation：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-8.png"><img class="aligncenter wp-image-7242" src="/images/52nlp.cn/02674cd20d6f5097f315a7e2cdd1fe62.jpg" alt="prml5-8" width="200" height="61"></a></p>
<p>每个ak输入一个输出层激活函数<a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-9.png"><img class="alignnone wp-image-7243" src="/images/52nlp.cn/9cce7d2ade857e08d21b7b2e4808c31d.jpg" alt="prml5-9" width="86" height="20"></a>，就得到了输出值。</p>
<p>这个从隐藏层到输出层的激活函数σ,根据不同应用，有不同的选择，例如回归问题的激活函数是identity函数,既y = a.分类问题的激活函数选择sigmoid函数，multiclass分类选择是softmax函数.</p>
<p>把上面各阶段的计算连起来，神经网络整个的计算过程就是：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-11.png"><img class="aligncenter wp-image-7244" src="/images/52nlp.cn/4f2892e794b058fd56e1e31409983032.jpg" alt="prml5-11" width="400" height="64"></a></p>
<p>上面计算过程是以2层神经网络为例。实际使用的NN可能有多层，记得听一个报告现在很火的deep learning的隐藏层有5-9层.这个计算过程forward propagation，从前向后计算。与此相反，训练时，会用back propagation从后向前来计算偏导数。</p>
<p>神经网络有很强的拟合能力，可以拟合很多种的曲线，这个图是书上的一个例子，对四种曲线的拟合：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-13.png"><img class="aligncenter wp-image-7245" src="/images/52nlp.cn/41907d61532018241e181a77e026cb64.jpg" alt="prml5-13" width="400" height="233"></a></p>
<p>第一部分神经网络的定义就这么多，大家有没有什么问题啊？</p>
<p>============================讨论=================================</p>
<p>阳阳(236995728) 19:20:43</p>
<p>输入层到隐藏层使用的激活函数与隐藏层到输出层的激活函数是否要一致？</p>
<p>网神(66707180) 19:21:11</p>
<p>两层激活函数不一定一致，输入层到隐藏层 经常是sigmoid函数。 而隐藏层到输出层，根据应用不同，选择不同.</p>
<p>牧云(1106207961) 19:22:30</p>
<p>一般的算法，比如神经网络，都有分类和拟合的功能，分类和拟合有共同点吗？为什么能拟合，这个问题我没有找到地方清晰的解释。</p>
<p>独孤圣者(303957511) 19:23:47</p>
<p>拟合和分类，在我看来实际上是一样的，分类无非是只有2个或多个值的拟合而已。2个值的拟合，被称为二值分类</p>
<p>ant/wxony(824976094) 19:24:30</p>
<p>不是吧，svm做二值分类，就不是以拟合为目标。二值拟合可以用做分类。</p>
<p>独孤圣者(303957511) 19:29:42</p>
<p>可以作为概率来理解吧，我个人认为啊，sigmoid函数，是将分类结果做一个概率的计算。</p>
<p>阳阳(236995728) 19:24:07</p>
<p>输入层到隐藏层 经常是sigmoid函数 那么也就是特征值变成了【0-1】之间的数了？</p>
<p>网神(66707180) 19:25:19</p>
<p>是的，我认为是.机器学习经常需要做特征归一化，也是把特征归一化到[0，1]范围。当然这里不只是归一化。</p>
<p>阳阳(236995728) 19:26:56</p>
<p>这里应该不是归一化的作用@网神</p>
<p>网神(66707180) 19:27:33</p>
<p>嗯，不是归一化，我觉得神经网络的这些做法，没有一个科学的解释。不像SVM每一步都有严谨的理论。</p>
<p>罗杰兔(38900407) 19:29:00</p>
<p>参数W,b是算出来的，还是有些技巧得到的。因为常听人说，神经网络难就难在调试参数上。</p>
<p>阳阳(236995728) 19:29:11</p>
<p>我觉得神经网络也是在学习新的特征 而这些特征比较抽象难于理解@牧云 @网神</p>
<p>网神(66707180) 19:29:48</p>
<p>对，我理解隐藏层的目的就是学习特征</p>
<p>阳阳(236995728) 19:30:24</p>
<p>是的 但是这些特征难于理解较抽象@网神</p>
<p>网神(66707180) 19:30:47</p>
<p>最后一个隐藏层到输出层之间，就是做分类或回归。前面的不同隐藏层，则是提取特征。</p>
<p>独孤圣者(303957511) 19:30:52</p>
<p>隐藏层的目的就是学习特征，这个表示赞同</p>
<p>网神(66707180) 19:31:33</p>
<p>后面讲到卷积网络时，可以很明显感受到，隐藏层的目的就是学习特征。</p>
<p>阳阳(236995728) 19:31:59</p>
<p>但是我不理解为什么隐藏层学习到的特征值介于【0-1】之间是合理的？是归一化的作用？</p>
<p>牧云(1106207961) 19:32:47</p>
<p>归一化映射</p>
<p>Wilbur_中博(1954123) 19:33:59</p>
<p>要归一化也是对每一个输入变量做吧。。各个输入变量都组合在一起了，归一化干嘛。我理解就是一个非线性变换，让神经网络具有非线性能力。sigmoid之外，其他非线性变换用的也蛮多的。和归一化没什么关系。不一定要在[0, 1]之间。</p>
<p>独孤圣者(303957511) 19:39:50</p>
<p>这个解释我很同意，tanh函数也经常替换sigmoid函数，在神经网络中普遍使用。</p>
<p>网神(66707180) 19:39:59</p>
<p>嗯，让NN具有非线性能力是主要原因之一。</p>
<p>牧云(1106207961) 19:40:03</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-14.png"><img class="aligncenter wp-image-7246" src="/images/52nlp.cn/e2a90aef450857c61c2b9a8001f6cd13.jpg" alt="prml5-14" width="400" height="208"></a></p>
<p>这个1要的干嘛</p>
<p>网神(66707180) 19:40:18</p>
<p>这个是偏置项，y = wx+b， 那个+1就是为了把b 合入w,变成　ｙ＝ｗｘ</p>
<p>罗杰兔(38900407) 19:41:36</p>
<p>Ng好象讲b是截距</p>
<p>网神(66707180) 19:43:16</p>
<p>截距和偏执项是一个意思。 放在坐标系上，b就是截距</p>
<p>阳阳(236995728) 19:40:33</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-15.png"><img class="alignnone wp-image-7247" src="/images/52nlp.cn/5c97d2d6365820bfb405c8bea3506ff9.jpg" alt="prml5-15" width="300" height="40"></a>它可以逼近任意的非线性函数吗@网神</p>
<p>网神(66707180) 19:42:13</p>
<p>书上没说可以逼近任意曲线，说的是逼近很多曲线</p>
<p>阳阳(236995728) 19:42:58</p>
<p>它到底是怎么逼近的啊@网神  我想看看多个函数叠加的？</p>
<p>网神(66707180) 19:44:30</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-16.png"><img class="aligncenter wp-image-7248" src="/images/52nlp.cn/b5f9b4ee6f7d0c10f18c7721db314c9e.jpg" alt="prml5-16" width="400" height="297"></a><br>
就是多个函数叠加。这个图上那个抛物线就是最终的曲线，由另外三条曲线叠加而成，另外那三条，每条是一个隐藏节点生成的曲线。</p>
<p>阳阳(236995728) 19:45:05</p>
<p>这三条曲线用的函数形式是不是一样的</p>
<p>zeno(117127143) 19:45:31</p>
<p>理解nn怎么逼近xor函数，就知道怎么非线性的了</p>
<p>HX(458728037) 19:45:56</p>
<p>问一句，你现在讲的是BP网络吧？</p>
<p>网神(66707180) 19:46:07</p>
<p>是BP网络</p>
<p>========================讨论结束===============================</p>
<p>网神(66707180) 19:46:59</p>
<p>接下来是神经网络的训练。神经网络训练的套路与第三，四章相同：确定目标变量的分布函数和似然函数，<br>
取负对数，得到error函数，用梯度下降法求使error函数最小的参数w和b。</p>
<p>NN的应用有：回归、binary分类、K个独立binary分类、multiclass分类。不同的应用决定了不同的激活函数、不同的目标变量的条件分布，不同的error函数.</p>
<p>首先，对于回归问题，输出变量t的条件概率符合高斯分布：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-17.png"><img class="aligncenter wp-image-7250" src="/images/52nlp.cn/59bd65aeaf585bee965e56fbe0373975.jpg" alt="prml5-17" width="300" height="41"></a></p>
<p>因此，给定一个训练样本集合，其似然函数是：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-18.png"><img class="aligncenter wp-image-7251" src="/images/52nlp.cn/d11e985e7e3f13e99987bd6dd2af40ac.jpg" alt="prml5-18" width="300" height="59"></a></p>
<p>error函数是对似然函数取 负对数，得到：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-19.png"><img class="aligncenter wp-image-7252" src="/images/52nlp.cn/7d51aa630ff270995d89f6e7e26529cb.jpg" alt="prml5-19" width="300" height="59"></a></p>
<p>最小化这个error函数，只需要最小化第一项，所以回归问题的errro函数定义是：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-20.png"><img class="aligncenter wp-image-7253" src="/images/52nlp.cn/f9318e1cc0e785d85d40ee1c263ca6b5.jpg" alt="prml5-20" width="300" height="58"></a></p>
<p>回归问题的隐藏层到输出层的激活函数是identity函数，也就是 <a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-21.png"><img class="alignnone wp-image-7254" src="/images/52nlp.cn/de4427cf9ee819098348e17004226616.jpg" alt="prml5-21" width="70" height="23"></a></p>
<p>ak就是对隐藏层节点的线性组合：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-22.png"><img class="aligncenter wp-image-7255" src="/images/52nlp.cn/624d58f619525abfee731c1c3098e806.jpg" alt="prml5-22" width="300" height="83"></a></p>
<p>这样有了error函数，就可以同梯度下降法求极值点.</p>
<p>再说说binary分类和multiclass分类的error函数：</p>
<p>binary分类的目标变量条件分布式伯努利分布：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-24.png"><img class="aligncenter wp-image-7256" src="/images/52nlp.cn/82de8ac138cddff7f3570f79acf1f326.jpg" alt="prml5-24" width="300" height="42"></a></p>
<p>这样，通过对似然函数取负对数，得到error函数如下：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-25.png"><img class="aligncenter wp-image-7257" src="/images/52nlp.cn/b61f91a5a35a40611cd8ca2ec8b2388e.jpg" alt="prml5-25" width="300" height="49"></a></p>
<p>另外binary分类，隐藏层到输出层的激活函数是sigmoid函数。对multiclass问题，也就是结果是K个互斥的类别中的一个.类似思路可以得到其error函数.这里就不说了。书上都有.</p>
<p>知道了error函数，和激活函数，这里先做一个计算，为后面的BP做准备，将E(w)对激活ak求导，可得：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-28.png"><img class="aligncenter wp-image-7258" src="/images/52nlp.cn/b57391a8ca28a913dfc8a5c889430156.jpg" alt="prml5-28" width="200" height="73"></a></p>
<p>这里有意思的是，不管是回归、binary分类还是multiclass分类，尽管其error函数不同，这个求导得出的结果都是yk-tk</p>
<p>回归问题这个求导很明显，下式中，y = a, 所以对a求导就是 y – t.</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-29.png"><img class="aligncenter wp-image-7259" src="/images/52nlp.cn/8cffa8a59d8cf9b5b60c1253d71f3b39.jpg" alt="prml5-29" width="300" height="67"></a></p>
<p>其他错误函数，需要推导一下，这里就不推了。有了error函数，用梯度下降法求其极小值点。</p>
<p>因为输入层到隐藏层的激活函数是非线性函数，所以error函数是非凸函数，所以可能存在很多个局部极值点。</p>
<p>两栖动物(9219642) 20:07:40</p>
<p>你这里说的回归问题是用神经网络拟合随机变量？</p>
<p>网神(66707180) 20:07:56</p>
<p>是的，就是做线性回归要做的事.只是用神经网络的方法，可以拟合更复杂的曲线。这是我的理解。</p>
<p>梯度下降法的思路就是对error函数求导，然后按下式对参数作调整：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-30.png"><img class="aligncenter wp-image-7260" src="/images/52nlp.cn/65092f33c1edb779b609dd078b5368a7.jpg" alt="prml5-30" width="300" height="46"></a></p>
<p>一直到导数为0，就找到了极值点.</p>
<p>这是基本思路，实际上很多算法，如共轭梯度法，拟牛顿法等，可以更有效的寻找极值点。因为梯度下降是机器学习中求极值点的常用方法，这些算法不是本章的内容，就不讲了，有专门的章节讲这些算法。</p>
<p>这里要讲的是error函数对参数w的求导方法，也就是back propagation后向传导法。<br>
可以高效的计算这个导数。</p>
<p>这个导数的计算利用的 求导数的链式法则， <a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-31.png"><img class="alignnone wp-image-7261" src="/images/52nlp.cn/655d67bf9874274f04ff2b3619f8ca49.jpg" alt="prml5-31" width="150" height="47"></a></p>
<p>把E对w的求导，转换成E对activation a的求导 和 a 对w 的求导. 这个地方因为涉及的式子比较多，我在纸上写了一下，我整个贴上吧：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-32.png"><img class="aligncenter wp-image-7262" src="/images/52nlp.cn/fff486cfd234de2d3b996fa2401695a7.jpg" alt="prml5-32" width="500" height="500"></a></p>
<p>大家看看，可以讨论一下</p>
<p>阳阳(236995728) 20:21:30</p>
<p>error function是负对数似然函数吧</p>
<p>网神(66707180) 20:21:38</p>
<p>是的</p>
<p>天上的月亮(785011830) 20:22:35</p>
<p>更新hidden层的w，为什么利用偏导的chain rule呢？</p>
<p>网神(66707180) 20:22:49</p>
<p>最主要的结论就是：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-35.png"><img class="wp-image-7264 aligncenter" src="/images/52nlp.cn/fe565148104f8710845b82cb0e70777a.jpg" alt="prml5-35" width="200" height="55"></a></p>
<p>对于输出层的节点，</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-36.png"><img class="alignnone size-full wp-image-7265" src="/images/52nlp.cn/6714e07da34f52a08de77926917e96f3.jpg" alt="prml5-36" width="31" height="31"></a> <a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-37.png"><img class="alignnone size-full wp-image-7266" src="/images/52nlp.cn/3bbc3d38c72005e29effce3cc2c8de17.jpg" alt="prml5-37" width="54" height="31"></a></p>
<p>对于隐藏层的节点，</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-38.png"><img class="alignnone size-full wp-image-7267" src="/images/52nlp.cn/f2d9b21802a0479863c600368176b125.jpg" alt="prml5-38" width="31" height="31"></a> <a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-39.png"><img class="alignnone size-full wp-image-7268" src="/images/52nlp.cn/331afcc36f88be8020ea588423d37c20.jpg" alt="prml5-39" width="99" height="31"></a></p>
<p>E对隐藏层节点w的导数，通过上式，就由输出层节点的导数 求得了.</p>
<p>有了上面求偏导数的方法，整个训练过程就是：<br>
1.输入一个样本Xn,根据forward propagation得到每个hidden单元和output单元的激活值a.<br>
2.计算每个output单元的偏导数<a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-40.png"><img class="alignnone wp-image-7269" src="/images/52nlp.cn/ba37c4a89b918434852c7844a6b91054.jpg" alt="prml5-40" width="30" height="27"></a></p>
<p>3.根据反向传导公式，计算每个hidden单元的<a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-42.png"><img class="alignnone wp-image-7270" src="/images/52nlp.cn/d5a1794198eb53534d07efc036d49700.jpg" alt="prml5-42" width="25" height="30"></a></p>
<p>4.计算偏导数。<br>
5.用一定的步长更新参数w。<br>
循环往复，一直找到满意的w。</p>
<p>独孤圣者(303957511) 20:32:09</p>
<p>BP时，是不是每个样本都要反馈一次？</p>
<p>网神(66707180) 20:33:32</p>
<p>应该是每个样本都反馈一次，batch也是.batch形式的每个样本反馈一次，将每个样本的偏导数求和，如下式，得到所有样本的偏导数，然后做一次参数w的调整.</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-43.png"><img class="aligncenter wp-image-7271" src="/images/52nlp.cn/7fed0a1cd8c4608ee8418b644c78d892.jpg" alt="prml5-43" width="250" height="93"></a></p>
<p>接下来就讲正则化，神经网络参数多，训练复杂，所以正则化方法也被研究的很多，书上讲了很多种的正则化方法. 第一个，就是在error函数上，加上正则项。<br>
第三章回归的正则项如下：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-45.png"><img class="aligncenter wp-image-7272" src="/images/52nlp.cn/f4833c1e6ecfbe0bf8d60c2d1fc84ac5.jpg" alt="prml5-45" width="350" height="45"></a></p>
<p>后面那一项对过大的w做惩罚。</p>
<p>但是对神经网络，正则项需要满足 一个缩放不变性，所以正则项的形式如下：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-48.png"><img class="alignnone wp-image-7273 size-full" src="/images/52nlp.cn/c6e00bbc43df0c771b5cf5072bd952bd.jpg" alt="prml5-48" width="84" height="25"></a> <a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-49.png"><img class="alignnone wp-image-7274 size-full" src="/images/52nlp.cn/a695d5c9e88933c020488d4676ee6a01.jpg" alt="prml5-49" width="107" height="28"></a></p>
<p>这个形式怎么推导出来的，大家看书吧，这里不说了。</p>
<p>书上讲到的第二种正则化方法是early stop，我理解的思路就是 在训练集上每调整一次w, 得到新的参数，就在验证集上验证一下。 开始在验证集上的error是逐渐下降的，后来就不下降了，会上升。那么在开始上升之前，就停止训练，那个参数就是最佳情况。</p>
<p>忘了说一个正则化注意对象了，就是隐藏节点的数量M。这个M是预先人为确定的，他的大小决定了整个模型的参数多少。所以是影响 欠拟合还是过拟合的 关键因素。</p>
<p>monica(909117539) 20:42:38</p>
<p>开始上升是出现了过拟合么？节点数量和层数都是怎样选择的呀？</p>
<p>网神(66707180) 20:42:56</p>
<p>开始上升就是过拟合了，是的，在训练集上，error还是下降的，但验证集上已经上升了。节点数量M是人为确定，我想这个数怎么定，是NN调参的重点。</p>
<p>monica(909117539) 20:44:36</p>
<p>：）</p>
<p>网神(66707180) 20:44:38</p>
<p>ML牛的人，叫做 调得一手好参，我觉得这里最能体现。</p>
<p>这个图是不同的M值对拟合情况的影响：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-50.png"><img class="aligncenter wp-image-7275" src="/images/52nlp.cn/81bd8fea05133d290cf9bc4f6a6b194b.jpg" alt="prml5-50" width="400" height="178"></a></p>
<p>另外，因为NN又不是凸函数，导致train更麻烦</p>
<p>monica(909117539) 20:47:01</p>
<p>嗯，这个能理解，前面模型太简单，欠拟合了，后面模型太复杂，就过拟合了。</p>
<p>网神(66707180) 20:47:08</p>
<p>需要尝试不同的M值，对于每一个M值，又需要train多次，每次随即初始化w的值，然后尝试找到不同的局部极值点。</p>
<p>上面说了三种正则化方法。接下来，因为神经网络在图像识别中，应用广泛，所以图像识别对正则化有些特殊的需求，就是 平移、缩放、旋转不变性。不知道这个需求在其他应用中，是否存在，例如NLP中，反正书上都是以图像处理为例讲的.</p>
<p>这些不变形，就是图像中的物体位置移动、大小变化、或者一定程度的旋转， 对ouput层的结果应该没有影响。</p>
<p>这里主要讲卷积神经网络。这个东东好像很有用，我看在Ng的deep learning教程中也重点讲了，当图像是大图时，如100×100像素以上，卷积网络可以大大减少参数w的个数.</p>
<p>卷积网络的input层的unit是图像的像素值.卷积网络的hidden层由卷积层和子采样层组成，如图：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-51.png"><img class="aligncenter wp-image-7276" src="/images/52nlp.cn/7c575040a39db2b44e223556d185b94f.jpg" alt="prml5-51" width="400" height="191"></a></p>
<p>一个卷及网络可能包括多个卷积层和子采样层，如下图有两对卷积/子采样层：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-53.png"><img class="aligncenter wp-image-7277" src="/images/52nlp.cn/ca52f3497bae2dfa1c0ea0085ce5aaf1.jpg" alt="prml5-53" width="400" height="203"></a></p>
<p>卷积层的units被划分成多个planes，每个plane是一个feature map，一个feature map里的一个unit只连接input层的一个小区域，一个feature map里的所有unit使用相同的weight值。<br>
卷积层的作用可以认为是提取特征。每个plane就是一个特征滤波器，通过卷积的方式提取图像的一种特征，过滤掉不是本特征的信息。比如提取100种特征，就会有100个plane，上图中，提取6个特征，第二层有6个平面。<br>
一个plane里面的一个unit与图像的一个子区域相连，unit的值表示从该区域提取的一个特征值。共有多少个子区域，plane里就有多少个unit。<br>
以上图为例，输入图像是32×32像素，所以input层有32×32个unit. 取子区域的大小为4×4，，那么共有28×28个子区域。每个子区域提取得到6个特征，对应第二层有6个plane， 每个plane有28×28个unit.</p>
<p>这样一个plane里的一个unit与输入层的4×4个unit相连，有16个权重weight值，这个plane里的其他unit都公用16个weight值.<br>
这样，6个平面，共有16×6=96个weight参数和6个bias参数.</p>
<p>下面说子采样层，上面说道，6个平面，每个平面有28×28个unit，所以第二层共有6x28x28个unit. 这是从图像中提取出来的特征，作为后一层的输入，用于分类或回归。<br>
但实际中，6个特征远远不够，图像也不一定只有32×32像素。假如从96×96像素中提取400个特征，子区域还是4×4，则第二层的unit会有 400 x (96-4) x (96-4) = 300多万。 超过300多万输入的分类器很难训练，也容易过拟合。<br>
这就通过子采样来减少特征。子采样就是把卷积层的一个平面划分成几部分，每个部分取最大值或平均值，作为子采样层的一个unit值.如下图：</p>
<p><a href="http://www.52nlp.cn/wp-content/uploads/2015/01/prml5-55.png"><img class="aligncenter wp-image-7278" src="/images/52nlp.cn/ef8bfaf29c84f1bab66b473c40e473bd.jpg" alt="prml5-55" width="400" height="201"></a></p>
<p>左边表示卷积层的一个plane，右边是这个plane的子采样结果。一个格子表示一个unit。<br>
把左边整个plane分成4部分，互相不重合，每个部分取最大值或平均值，作为右边子采样层的一个unit。这样子采样层一个plane只有4个unit。</p>
<p>通过卷积和子采样：得到的特征作为下一层分类或回归的输入。<br>
主要好处：<br>
a. 这样输入层的各种变形在后面就会变得不敏感。如果有多对 卷积/子采样，每一对就将不变形更深入一层。<br>
b. 减少参数的个数。就这么多了，大家慢慢看。</p>
<p>阳阳(236995728) 21:01:30</p>
<p>关于卷积神经网络的材料有吗？@网神</p>
<p>阿邦(1549614810) 21:01:44</p>
<p>问个问题，cnn怎么做的normalization？</p>
<p>网神(66707180) 21:03:26</p>
<p>卷积网络的材料，我看了书上的，还有Andrew Ng的deep learning里讲的，另外网上搜了一篇文章</p>
<p>这里我贴下链接。</p>
<p>罗杰兔(38900407) 21:04:19</p>
<p>不大明白为什么可以采样，怎么保证采样得到的信息正好是我们需要的</p>
<p>阿邦(1549614810) 21:05:01</p>
<p>采样是max pooling，用于不变性</p>
<p>网神(66707180) 21:05:02</p>
<p>http://ibillxia.github.io/blog/2013/04/06/Convolutional-Neural-Networks/</p>
<p>牧云(1106207961) 21:05:02</p>
<p>采样是随机的吗？</p>
<p>网神(66707180) 21:06:40</p>
<p>传了个deep learning教程。这是Andrew Ng上课的notes, 网上一些人众包翻译的，我觉得翻译的不错。里面讲了神经网络、卷积网络，和其他深度网络的东西。</p>
<p>采样不是随机的。</p>
<p>牧云(1106207961) 21:08:04</p>
<p>卷积提取的特征具有稳定性吗</p>
<p>阿邦(1549614810) 21:08:56</p>
<p>据说要数据量很大才可以</p>
<p>网神(66707180) 21:09:03</p>
<p>卷积层和子采样层主要是 解决 不变性问题 和减少参数w数量问题，所以可以起到泛化作用.<br>
注：PRML读书会系列文章由 <a href="http://weibo.com/dmalgorithms">@Nietzsche_复杂网络机器学习</a> 同学授权发布，转载请注明原作者和相关的主讲人，谢谢。</p>
<p>PRML读书会讲稿PDF版本以及更多资源下载地址：<a href="http://vdisk.weibo.com/u/1841149974">http://vdisk.weibo.com/u/1841149974</a></p>
<p>本文链接地址：<a href="http://www.52nlp.cn/prml%E8%AF%BB%E4%B9%A6%E4%BC%9A%E7%AC%AC%E4%BA%94%E7%AB%A0-neural-networks">http://www.52nlp.cn/prml读书会第五章-neural-networks</a></p>

  </article>

  <div class="meta">

    <a class="basic-alignment left" href="/posts/2015/2015-01-26-83597-cf094ab82.html" title="Previous Post: SQL Server调优系列玩转篇二（如何利用汇聚联合提示（Hint）引导语句运行）" data-instant>&laquo; SQL Server调优系列玩转篇二（如何利用汇聚联合提示（Hint）引导语句运行）</a>

    <a class="basic-alignment right" href="/posts/2015/2015-01-28-83821-cb2ee3ffb.html" title="Next Post: .NET中使用Redis" data-instant>.NET中使用Redis &raquo;</a>

</div>
  <div id="related">
  <h2 class="subheader">Related Posts <small>They might be useful</small></h2>
  <ul class="posts">

      <li><span>07 Feb 2017</span> &raquo; <a href="http://iftti.com/posts/2017/2017-02-07-110052-111b13f41.html">研发团队 GIT 开发流程新人学习指南</a></li>

      <li><span>06 Feb 2017</span> &raquo; <a href="http://iftti.com/posts/2017/2017-02-06-110076-fcd8bd876.html">垃圾回收原来是这么回事</a></li>

      <li><span>06 Feb 2017</span> &raquo; <a href="http://iftti.com/posts/2017/2017-02-06-110072-cea0048e7.html">每天一个 Linux 命令（59）： rcp 命令</a></li>

  </ul>
</div>

<comments>

<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1936498"></script>
<!-- UY END -->

</comments>

</div>
      <!-- JiaThis Button BEGIN -->
<div class="jiathis_share_slide jiathis_share_24x24" id="jiathis_share_slide">
<div class="jiathis_share_slide_top" id="jiathis_share_title"></div>
<div class="jiathis_share_slide_inner">
<div class="jiathis_style_24x24">
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_googleplus"></a>
<a class="jiathis_button_twitter"></a>
<a class="jiathis_button_linkedin"></a>
<a class="jiathis_button_weixin"></a>
<a class="jiathis_button_cqq"></a>
<a class="jiathis_button_renren"></a>
<a class="jiathis_button_evernote"></a>
<a class="jiathis_button_pocket"></a>
<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'
	,slide:{
		divid:'wrap',
		pos:'left',
		gt:'true'
	}
};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1936498" charset="utf-8"></script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_slide.js" charset="utf-8"></script>
</div></div></div>
<!-- JiaThis Button END -->
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">IT技术干货</h2>

    <div class="footer-col-1 column">
      <p class="text">IT技术干货 KernelHacks 最好的技术站点 技术信息 纯干货</p>
      <ul>
        <li>汇集最好的科技与互联网信息</li>
        <li>Liu Lantao</li>
        <li><a href="mailto:iftti@iftti.com">iftti@iftti.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/Lax">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">Lax</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/liulantao">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">@liulantao</span>
          </a>
        </li>
        <li>
          <a href="https://plus.google.com/+LiuLantao">
            <span class="icon googleplus">
              <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                width="16px" height="16px" viewBox="0 0 134.658 131.646" enable-background="new 0 0 134.658 131.646"
                xml:space="preserve">
                <g>
                  <path fill="#C2C2C2" d="M126.515,4.109H8.144c-2.177,0-3.94,1.763-3.94,3.938v115.546c0,2.179,1.763,3.942,3.94,3.942h118.371
                  c2.177,0,3.94-1.764,3.94-3.942V8.048C130.455,5.872,128.691,4.109,126.515,4.109z"/>
                  <g>
                    <path fill="#FFFFFF" d="M70.479,71.845l-3.983-3.093c-1.213-1.006-2.872-2.334-2.872-4.765c0-2.441,1.659-3.993,3.099-5.43
                    c4.64-3.652,9.276-7.539,9.276-15.73c0-8.423-5.3-12.854-7.84-14.956h6.849l7.189-4.517H60.418
                    c-5.976,0-14.588,1.414-20.893,6.619c-4.752,4.1-7.07,9.753-7.07,14.842c0,8.639,6.633,17.396,18.346,17.396
                    c1.106,0,2.316-0.109,3.534-0.222c-0.547,1.331-1.1,2.439-1.1,4.32c0,3.431,1.763,5.535,3.317,7.528
                    c-4.977,0.342-14.268,0.893-21.117,5.103c-6.523,3.879-8.508,9.525-8.508,13.51c0,8.202,7.731,15.842,23.762,15.842
                    c19.01,0,29.074-10.519,29.074-20.932C79.764,79.709,75.344,75.943,70.479,71.845z M56,59.107
                    c-9.51,0-13.818-12.294-13.818-19.712c0-2.888,0.547-5.87,2.428-8.199c1.773-2.218,4.861-3.657,7.744-3.657
                    c9.168,0,13.923,12.404,13.923,20.382c0,1.996-0.22,5.533-2.762,8.09C61.737,57.785,58.762,59.107,56,59.107z M56.109,103.65
                    c-11.826,0-19.452-5.657-19.452-13.523c0-7.864,7.071-10.524,9.504-11.405c4.64-1.561,10.611-1.779,11.607-1.779
                    c1.105,0,1.658,0,2.538,0.111c8.407,5.983,12.056,8.965,12.056,14.629C72.362,98.542,66.723,103.65,56.109,103.65z"/>
                    <polygon fill="#FFFFFF" points="98.393,58.938 98.393,47.863 92.923,47.863 92.923,58.938 81.866,58.938 81.866,64.469
                    92.923,64.469 92.923,75.612 98.393,75.612 98.393,64.469 109.506,64.469 109.506,58.938"/>
                  </g>
                </g>
              </svg>
            </span>
            <span class="username">+LiuLantao</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">

<!--以下是QQ邮件列表订阅嵌入代码--><script >var nId = "6be92ef3590ee662cd5e6381ab2044c328716364f684cf3e",nWidth="auto",sColor="light",sText="填写您的邮件地址，订阅我们的精彩内容：" ;</script><script src="http://list.qq.com/zh_CN/htmledition/js/qf/page/qfcode.js" charset="gb18030"></script>

    </div>

  </div>

  <div class="wrap">
    <div>
      <a href="http://blog.liulantao.com">Blog</a> | <a href="http://1000bit.com">铅笔特评 1000bit</a> | <a href="http://visplanet.com">VisPlanet</a> | <a href="http://iftti.com">IT技术干货</a> | <a href="http://relax.org.cn">Relax</a> | <a href="http://hangzhou.io">杭州城市指南</a>
    </div>
  </div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1658815-7', 'iftti.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>

</footer>

    </body>
</html>