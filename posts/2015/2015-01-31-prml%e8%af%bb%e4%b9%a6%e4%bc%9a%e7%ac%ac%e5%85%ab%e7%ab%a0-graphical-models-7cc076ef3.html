<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>PRML读书会第八章  Graphical Models | IT技术干货</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="IT技术干货 KernelHacks 最好的技术站点 技术信息 纯干货">
    <link rel="canonical" href="http://iftti.com/posts/2015/2015-01-31-prml%25e8%25af%25bb%25e4%25b9%25a6%25e4%25bc%259a%25e7%25ac%25ac%25e5%2585%25ab%25e7%25ab%25a0-graphical-models-7cc076ef3.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

</head>

    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">IT技术干货</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">

          <a class="page-link" href="/about/">About</a>

      </div>
    </nav>

  </div>

</header>

    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>PRML读书会第八章  Graphical Models</h1>
    <p class="meta"><span class="time">Jan 31, 2015</span><span class="source_url"> • 来自 52nlp.cn <a name="52nlp.cn" href="http://www.52nlp.cn/prml%e8%af%bb%e4%b9%a6%e4%bc%9a%e7%ac%ac%e5%85%ab%e7%ab%a0-graphical-models" target="_blank">[原文链接]</a></span></p>
  </header>

  <article class="post-content">

						<p style="text-align: center;background: white"><span style="font-family: 微软雅黑;font-size: 15pt"><strong>PRML读书会<span style="color: black">第八章 Graphical Models<br>
</span></strong></span></p>
<p style="text-align: center;background: white"><span style="color: black;font-family: 微软雅黑;font-size: 15pt"><strong>主讲人 网神<br>
</strong></span></p>
<p style="text-align: center;background: white"><span style="color: black;font-family: 微软雅黑;font-size: 12pt"><strong>（新浪微博: <a href="http://weibo.com/ghtimaq">@豆角茄子麻酱凉面</a>）<br>
</strong></span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">网神(66707180) 18:52:10<br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">今天的内容主要是：<br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">1.贝叶斯网络和马尔科夫随机场的概念，联合概率分解，条件独立表示；2.图的概率推断inference。<br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">图模型是用图的方式表示概率推理 ，将概率模型可视化，方便展示变量之间的关系，概率图分为有向图和无向图。有向图主要是贝叶斯网络，无向图主要是马尔科夫随机场。对两类图，prml都讲了如何将联合概率分解为条件概率，以及如何表示和判断条件依赖。<br>
先说贝叶斯网络，贝叶斯网络是有向图，用节点表示随机变量，用箭头表示变量之间的依赖关系。一个例子:<br>
</span><span id="more-7603"></span></p>
<p style="background: white"><img src="/images/52nlp.cn/711dd31ad211f0e208691384f21bebbe.jpg" alt=""><span style="color: black;font-family: 微软雅黑;font-size: 9pt"><br>
这是一个有向无环图，这个图表示的概率模型如下:<br>
p(x1,x2,…x7)= <img src="/images/52nlp.cn/240009b30917c75e6e8dea72da7c15f8.jpg" alt="">形式化一下，贝叶斯网络表示的联合分布是：<br>
<img src="/images/52nlp.cn/74f8f5620ef90e699e0342640893699b.jpg" alt=""><br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">其中<img src="/images/52nlp.cn/81e64fe6e9f426a5b1fefd362bab6542.jpg" alt="">是xk的所有父节点。<br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">以上是贝叶斯网络将联合概率分解为条件概率的方法，比较直观易懂，就不多说了。下面说一下条件独立的表示和判断方法。条件独立是，给定a,b,c三个节点，如果p(a,b|c)=p(a|c)p(b|c)，则说给定c，a和b条件独立。当然 a, b, c也可以是三组节点，这里只以单个节点为例。用图表示，有三种情况 。<br>
第一种情况如图：<br>
<img src="/images/52nlp.cn/dcb19345aa1d8d4667bee7cb594a98c9.jpg" alt=""><br>
c位于两个箭头的尾部，称作tail-to-tail，这种情况，c未知的时候，a，b是不独立的。c已知的时候，a,b条件独立。来看为什么，首先，这个图联合概率如下：<br>
在c未知的时候,p(a,b)如下求解:<br>
<img src="/images/52nlp.cn/cdb88b875a38905cd10f8b30a9fdfe2e.jpg" alt=""><br>
可以看出，无法得出:p(a,b)=p(a)p(b)，所以a,b不独立。<br>
如果c已知，则：<br>
</span></p>
<p style="background: white"><img src="/images/52nlp.cn/20331242043b319984d3d085b162a187.jpg" alt=""><span style="color: black;font-family: 微软雅黑;font-size: 9pt"><br>
所以a,b条件独立于c。条件独立用以下符号表示：<br>
<img src="/images/52nlp.cn/4ee6105a10bd19978f490fdf3db351be.jpg" alt=""><br>
a,b不独立的符号表示:：<br>
<img src="/images/52nlp.cn/59487f132a9f73a1f28adb3a4bb993d0.jpg" alt=""><br>
这是图表示的条件独立的第一种形式，叫做tail-to-tail。第二种是tail-to-head，如图：<br>
<img src="/images/52nlp.cn/167997121e6a661fe1e5c6f4494fbbfb.jpg" alt=""><br>
这种情况也是c未知时，a和b不独立。c已知时，a和b条件独立于c，推导如下：<br>
<img src="/images/52nlp.cn/e54196de84b7b77e7d95a53330fcacb5.jpg" alt=""><br>
第三种情况是head-to-head，如图：<br>
<img src="/images/52nlp.cn/f615cf610671e1a7e35d0cc8113996d5.jpg" alt=""><br>
这种情况反过来了，c未知时，a和b是独立的；但当c已知时，a和b不满足条件独立，<br>
因为：<img src="/images/52nlp.cn/9125f163f71810ae944df8a9838e0612.jpg" alt=""><br>
计算该概率的边界概率，得<br>
<img src="/images/52nlp.cn/8c54ccb844643a221887efc4f4d5c016.jpg" alt=""><br>
所以a和b相互独立.<br>
但c已知时：<br>
<img src="/images/52nlp.cn/08329d123764480718e95f9b24b560d2.jpg" alt=""><br>
无法得到p(a,b|c)=p(a|c)p(b|c)<br>
将这三种情况总结，就是贝叶斯网络的一个重要概念，D-separation，这个概念的内容就是:<br>
A,B,C三组节点，如果A中的任意节点与B的任意节点的所有路径上，存在以下节点，就说A和B被C阻断:<br>
1, A到B的路径上存在tail-to-tail或head-to-tail形式的节点，并且该节点属于C<br>
2. 路径上存在head-to-head的节点，并且该节点不属于C<br>
举个例子：<br>
</span></p>
<p style="background: white"><img src="/images/52nlp.cn/53312848ea6cc6fa4fe45ee72a517857.jpg" alt=""><span style="color: black;font-family: 微软雅黑;font-size: 9pt"><br>
左边图上，节点f和节点e都不是d-separation.因为f是tail-to-tail，但f不是已知的，因此f不属于C.<br>
e是head-to-head，但e的子节点c是已知的，所以e也不属于C。<br>
speedmancs&lt;speedmancs@qq.com&gt; 19:23:05<br>
2漏了一点，该节点包括所有后继<br>
网神(66707180) 19:23:21<br>
右边图，f和e都是d-separation.理由与上面相反.对，是漏了这一点。看到这个例子才想起来，这部分大家有什么问题没？<br>
speedmancs&lt;speedmancs@qq.com&gt; 19:24:54<br>
这个还是抽象了一些，我之前看的prml这一章，没看懂，后来看了PGM前三章，主要看了那个学生成绩的那个例子，就明白了。姑妄记之，其实蛮不好记的。讲得挺好的，继续。<br>
网神(66707180) 19:27:14<br>
因为有了这些条件独立的规则，可以将图理解成一个filter。<br>
既给定一系列随机变量，其联合分布p(x1,x2…,xn)理论上可以分解成各种条件分布的乘积，但过一遍图，不满足图表示依赖关系和条件独立的分布就被过滤掉。所以图模型，用不同随机变量的连接表示各种关系，可以表示复杂的分布模型。<br>
接下来是马尔科夫随机场，是无向图，也叫马尔科夫网络，马尔科夫网络也有条件独立属性。<br>
用MRF(malkov random field)表示马尔科夫网络，MRF因为是无向的，所以不存在tail-to-tail这些概念。MRF的条件独立如图：<br>
<img src="/images/52nlp.cn/078f0292ee0e167d5b57e39f2f33a3b9.jpg" alt=""><br>
如果A的任意节点和B的任意节点的任意路径上，都存在至少一个节点属于C<br>
speedmancs&lt;speedmancs@qq.com&gt; 19:33:16<br>
无向图的条件独立 比有向图简单多了。<br>
网神(66707180) 19:33:18<br>
那么A和B条件独立于C，可以理解为，如果C的节点都是已知的，就阻断了A和B的所有路径。<br>
网神(66707180) 19:33:49<br>
嗯，MRF的 概率分解就概念比较多了，不像有向图那么直观，MRF联合概率分解成条件概率。用到了clique的概念，我翻译成”团”，就是图的一个子图，子图上两两节点都有连接. 例如这个图，最大团有两个，分别是(x1,x2,x3)和(x2,x3,x4)：<br>
<img src="/images/52nlp.cn/9e79837e987cd2dc6d65684894f97413.jpg" alt=""><br>
MRF的联合概率分解另一个概念是potential function，联合概率分解成一系列potential函数的乘积:<br>
<img src="/images/52nlp.cn/1d5657c5f5a06a5bde0c9b9191c61124.jpg" alt=""><br>
</span></p>
<p style="background: white"><img src="/images/52nlp.cn/1a6025a85cd29be822854607d38f0843.jpg" alt=""><span style="color: black;font-family: 微软雅黑;font-size: 9pt">是一个最大团的所有节点，一个potential函数<img src="/images/52nlp.cn/a323fb98bb812323c011f2b2580f21d1.jpg" alt="">，是最大团的一个函数.<br>
这个函数具体的定义是依赖具体应用的，一会举个例子.<br>
上面式子里那个Z是normalization常量：<br>
<img src="/images/52nlp.cn/2710737c2857506f56039c1fafe3dcdc.jpg" alt=""><br>
speedmancs&lt;speedmancs@qq.com&gt; 19:42:47<br>
这个Z很麻烦<br>
网神(66707180) 19:43:15<br>
在这个式子里<img src="/images/52nlp.cn/529938c377158d69ed2a5a35791dc4d4.jpg" alt="">，p(x)是一系列potential函数的乘积。换一种理解方式，定义将potential函数表示成指数函数:<br>
<img src="/images/52nlp.cn/f3ef8cad75c98f0b2ee4d97a21d51902.jpg" alt=""><br>
这样p(x)就可以表示成一系列E(Xc)的和的指数函数，E(Xc)叫做能量函数，这么转换之后，可以将图理解成一个能量的集合，他的值等于各个最大团的能量的和.先举个例子看看potential函数和能量函数在具体应用中是什么样的，大家再讨论。<br>
要把噪声图片尽量还原成 原图，用图的方式表示噪声图和还原后的图，每个像素点是一个节点:<br>
<img src="/images/52nlp.cn/fbe5e6aad5e858efd74fc9405d7db1b4.jpg" alt=""><br>
上面那层Yi，是噪声图，紫色表示这些是已知的，是观察值。下面那层Xi是未知的，要求出Xi，使Xi作为像素值得到的图，尽量接近无噪声图片。每个xi的值，与yi相关，也与相邻的xj相关。这里边，最大团是(xi, yi)和(xi, xj)，两类最大团。<br>
对于(xi, yi)，选择能量函数E(xi,yi)=<img src="/images/52nlp.cn/1bb01c9ebf347758bffb277296a3773a.jpg" alt="">；对于(xi,xj)，选择能量函数E(xi, xj)=<img src="/images/52nlp.cn/bea0d1d974cb1d1328298a50269effba.jpg" alt=""><br>
两个能量函数的意思都是，如果xi和yi (或xi和xj)的值相同，则能量小；如果不同，则能量大.<br>
整个图的能量如下：<br>
<img src="/images/52nlp.cn/e7573463095c637a611ffbdc9815e918.jpg" alt=""><br>
</span></p>
<p style="background: white"><img src="/images/52nlp.cn/aa64bd639bca57abb6382807b8c54fc6.jpg" alt=""><span style="color: black;font-family: 微软雅黑;font-size: 9pt">是一个偏置项<br>
speedmancs&lt;speedmancs@qq.com&gt; 19:56:55<br>
偏置项是一种先验吧<br>
网神(66707180) 19:57:28<br>
有了这个能量函数，接下来就是求出Xi，使得能量E(x,y)最小。求最小，书上简单说了一下，我的理解也是用梯度下降类似的方法。<br>
speedmancs&lt;speedmancs@qq.com&gt; 19:57:34<br>
这里表示-1的点更多吧。<br>
网神(66707180) 19:58:20<br>
对偏执项的作用，书上这么解释：Such a term has the effect of biasing the model towards pixel values that have one particular sign in preference to the other.<br>
speedmancs&lt;speedmancs@qq.com&gt; 19:59:29<br>
恩，对，让能量最小<br>
网神(66707180) 19:59:39<br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">为了使E(x,y)尽量小，是尽量让xi选择-1，而不是1。E(x,y)越小，得到的图就越接近无噪声的图，因为：<br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt"><br>
<img src="/images/52nlp.cn/17fe077bd1cd61e2bcf88c8e3856f8e2.jpg" alt=""><br>
所以E(x,y)越小，p(x,y)就越大。<br>
η&lt;liyitan2144@163.com&gt; 20:01:13<br>
是不是可以这样看，<img src="/images/52nlp.cn/02fb8032fb5a670e9c6ddb53977d247a.jpg" alt="">表示平滑；<img src="/images/52nlp.cn/767ab9ef9b394c9e6842bb0f6f9a8546.jpg" alt="">表示似然。<br>
网神(66707180) 20:02:18<br>
liyitan2144说得好，<img src="/images/52nlp.cn/f7a363d2fae2929c533b7eebf412dee5.jpg" alt=""><br>
speedmancs&lt;speedmancs@qq.com&gt; 20:02:33<br>
恩，所以这是一个 产生式模型。<br>
网神(66707180) 20:02:59<br>
有向图和无向图的概率分解 和 条件独立 都说完了.有向图和无向图是可以互相转换的，有向图转换成无向图，如果每个节点都只有少于等于1个父节点，比较简单。如果有超过1个父节点，就需要在转换之后的无向图上增加一些边，来避免都是有向图上的一些关系，这部分就不细说了。<br>
下面要说图的inference了。前面大家有啥要讨论的？先讨论一下吧。<br>
</span></p>
<p><span style="color: #333333"><span style="font-family: Arial">============================</span><span style="font-family: 宋体">讨论</span><span style="font-family: Arial">=================================<br>
</span></span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">speedmancs&lt;speedmancs@qq.com&gt; 20:06:45<br>
刚才那个例子中，那几个beta, h等参数如何得到？<br>
网神(66707180) 20:07:30<br>
那个是用迭代求解的方法，求得这几个参数，书上提到了两种方法，一种ICM,iterated conditional modes<br>
一种max-product方法，其中max-product方法效果比较好,在后面的inference一节里详细讲了这个方法，而ICM方法只是提了一下，原理没有细说.两种方法的效果看下图,左边是ICM的结果，右边是max-product的方法：<br>
<img src="/images/52nlp.cn/1fda0c07f6f3fe74fdb1f5fd01ba140e.jpg" alt=""><br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">speedmancs&lt;speedmancs@qq.com&gt; 20:15:07<br>
稍微插一句，刚才那个denoise的例子，最好的那个结果是graph cut，而且那几个beta参数是事先固定了。<br>
η&lt;liyitan2144@163.com&gt; 20:16:12<br>
graph cut是指？<br>
kxkr&lt;lxfkxkr@126.com&gt; 20:16:30<br>
<img src="/images/52nlp.cn/777fee0478174419b50c2e7f2181b32b.jpg" alt="">kxkr&lt;lxfkxkr@126.com&gt; 20:17:18<br>
<img src="/images/52nlp.cn/4d57459d061b12b5306943839c821a92.jpg" alt=""><br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">网神(66707180) 20:18:11<br>
这个例子只是为了说明能量函数和潜函数.所以不一定是最佳方法，这两段截屏是prml上的，咋没看到捏<br>
kxkr&lt;lxfkxkr@126.com&gt; 20:19:05<br>
那几个参数如何得到 文中好像并没有说，只是说了ICM、graph-cut能够得到最后的去噪图像，第一段 在 figure8.30，第二个截图在 section8.4，figure8.32下面。<br>
网神(66707180) 20:20:15<br>
看到了，先不管这个吧，主要知道能量函数是啥样的就行了<br>
kxkr&lt;lxfkxkr@126.com&gt; 20:21:25<br>
嗯<br>
</span></p>
<p><span style="color: #333333"><span style="font-family: Arial">========================</span><span style="font-family: 宋体">讨论结束</span><span style="font-family: Arial">==============f===================<br>
</span></span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">网神(66707180) 20:22:24<br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">接着说inference了，inference就是已知一些变量的值，求另一些变量的概率<br>
</span></p>
<p style="background: white"><img src="/images/52nlp.cn/cbe9bf98180a14cb5045dca1794dc84d.jpg" alt=""><span style="color: black;font-family: 微软雅黑;font-size: 9pt"><br>
比如上图，已知y，求x的概率<br>
这个简单的图可以用典型的贝叶斯法则来求<br>
<img src="/images/52nlp.cn/7e71122e14cfaa88afdd58296b070111.jpg" alt=""><br>
对于复杂点的情况，比如链式图：<br>
<img src="/images/52nlp.cn/3635e536873f2f8fc72de50279ebdd3d.jpg" alt=""><br>
为了求p(xn)，就是求xn的边界概率。这里都假设x的值是离散的。如果是连续的，就是积分，为了求这个边界概率，做这个累加动作，如果x的取值是k个，则要做k的(N-1)次方次计算，利用图结构，可以简化计算，这个简化方法就不讲了。<br>
下面讲通用的图inference的方法，就是factor graph方法，链式图或树形图，都比较好求边界概率。<br>
所以factor graph就是把复杂的图转换成树形图，针对树形图来求.先说一下什么是树形图，树形图有两种情况：<br>
1. 每个节点只有一个父节点。<br>
2. 如果有的节点有多个父节点，必须图上每个节点之间只有一条路径。<br>
这是树形图的三种情况：<br>
</span></p>
<p><span style="font-family: 宋体;font-size: 12pt"><br>
<img src="/images/52nlp.cn/8eb9c9545ad3c13c7fad9613b7a21b60.jpg" alt=""><br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">对于无向图，只要无环，都可以看做树形图；对于有向图，必须每两个节点之间只有一条路径；中间那种是典型的树.右边那种多个有多个节点的叫polytree。<br>
这种书结构的图，都比较好求边界概率. 具体怎么求，就不说了。<br>
这里主要说怎么把复杂的图转换成树形图.，这种转换引入factor节点，从而将普通的图转换成factor图.<br>
先看个例子：<br>
<img src="/images/52nlp.cn/780cb05565153f42f5c16af41ffb2745.jpg" alt=""><br>
对于这个有向图，p(x1,x2,x3)=p(x1)p(x2|x1)p(x3|x1,x2)，等号右边的三个概率作为三个factor<br>
每个factor作为一个节点，加入新的factor图中：<br>
<img src="/images/52nlp.cn/b73761b2e92ab0e5ee900c85c690fced.jpg" alt=""><br>
上面的x1,x2,x3是原图的随机变量 ，下面的fa,fb,fc,fd是factor节点，只有随即变量节点和factor节点之间有连接，每类节点自身互不连接，每个factor连接的变量节点，是相互依赖的节点。<br>
kxkr&lt;lxfkxkr@126.com&gt; 20:42:10<br>
就是一个clique中的节点吧<br>
网神(66707180) 20:42:19<br>
对，严格的说，也不是。<br>
kxkr&lt;lxfkxkr@126.com&gt; 20:44:15<br>
对于有向图 ？<br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">网神(66707180) 20:45:10<br>
x1,x2,x3是一个最大团. 可以只用一个factor节点，如中间那个图<br>
kxkr&lt;lxfkxkr@126.com&gt; 20:45:17<br>
嗯<br>
网神(66707180) 20:45:22<br>
也可以用多个factor节点，如右边图，但什么情况下用一个factor什么情况用多个factor，我没想明白<br>
kxkr&lt;lxfkxkr@126.com&gt; 20:47:10<br>
嗯，继续<br>
网神(66707180) 20:47:21<br>
转换成factor图后，就是树形图了，符合前面树形图的两种情况，这时候，要求一个节点或一组节点的边界概率，用一种叫做sum-product的方法，已求一个节点的边界概率为例.<br>
η&lt;liyitan2144@163.com&gt; 20:49:50<br>
<img src="/images/52nlp.cn/bce8e43c96148fe947b45673d132458d.jpg" alt="">虽然也对具体的应用情景不清楚，但是一个factor能表达的信息比使用多个factor能表达的信息多.<br>
网神(66707180) 20:51:06<br>
单个的factor表达的信息多，而且节点越少，计算越简单，所以是不是尽量用少的factor？max-product求单个节点的边界概率，其思想是以该节点为root。<br>
η&lt;liyitan2144@163.com&gt; 20:52:38<br>
但是，从设计模型的角度看，节点少了，一个节点设计的复杂程度就大了，不一定容易设计，拆解成多个factor，每个factor都很简单，设计方便。<br>
kxkr&lt;lxfkxkr@126.com&gt; 20:54:37<br>
文中貌似倾向于一个单个的factor<br>
<img src="/images/52nlp.cn/ab7496f79bbd3a88c5efdc07bfc7f41e.jpg" alt="">η&lt;liyitan2144@163.com&gt; 20:56:57<br>
这貌似是在表达一个通用的方法，和是把大的clique的factor拆解成小的多个factor没有关系。<br>
kxkr&lt;lxfkxkr@126.com&gt; 20:57:53<br>
拆成多个factor是不是会造成参数变多，不容易求呢，继续吧，这个有待实践。η&lt;liyitan2144@163.com&gt; 21:00:00<br>
参数应该会变多吧，不过模型其实简单了，确实有待实践，我觉得这和具体应用有关，比如在一副图像里面，如果仅仅表达”像素”的相似度，我们完全可以使用小factor。<br>
网神(66707180) 21:00:39<br>
我继续，prml这章图模型只讲了基础的概念，没讲常用的图模型实例，HMM和CRF这两大主流图模型方法还没讲，感觉不够直观.<br>
</span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">我继续说inference. 转换成factor图后，求节点xi的边缘概率。把xi作为root节点,把求root边界概率理解成一个信息(message)传递的过程，从叶子节点传递概率信息到root节点.传递的规则是：<br>
从叶子节点开始，如果叶子是变量节点，发送1给父节点,如果叶子是factor节点，发送f(x)给父节点.<br>
对于非叶子节点，如果是变量节点，将其收到的message相乘，发给父节点，如果是factor节点，将其收到的message和自身f(x)相乘，然后做一个sum，发给父节点。<br>
举个例子：<br>
<img src="/images/52nlp.cn/6abcc733a0eef13480d910dcbbf65917.jpg" alt=""><br>
这个图中求x3的边缘概率，message传递的过程是:<br>
<img src="/images/52nlp.cn/373711657bf8fc457039064b2160f500.jpg" alt=""><br>
<img src="/images/52nlp.cn/c3a6215edc71bf7e8f686093c75d3eb4.jpg" alt="">中的<img src="/images/52nlp.cn/76860163e1ac4afd0716cb30dc461b10.jpg" alt="">表示从节点x1传递到fa，最后p(x3)是等于<img src="/images/52nlp.cn/6c1d66db3d4502367458e64206cbbeca.jpg" alt="">，因为只有一个fb节点向其传入信息，如果要求x2的边界概率,因为x2有三个节点出入信息,分别是：<br>
</span></p>
<p style="background: white"><img src="/images/52nlp.cn/5251644e28bcc5c37856419b42209fe7.jpg" alt=""><img src="/images/52nlp.cn/3763991ca8d8df08824cbe3afa03a122.jpg" alt=""><img src="/images/52nlp.cn/fb058e2e7185d55c95cdfd5caab7bccc.jpg" alt=""><span style="font-family: 微软雅黑;font-size: 9pt"><span style="color: black"><br>
所以p(x2)就等于这三个信息的乘积<br>
<img src="/images/52nlp.cn/1123302e409577b601ed6d165ec7ffa9.jpg" alt=""></span><span style="color: red"><br>
</span><span style="color: black">这个结果与边界分布的定义是相符的，x2的边界定义如下：<br>
<img src="/images/52nlp.cn/a10834c216091c29e028a5dcefbcfb45.jpg" alt=""><img src="/images/52nlp.cn/eaae67fffb2d9a5038ead38c5fdbbc0b.jpg" alt=""><br>
<img src="/images/52nlp.cn/09d6d75acf7191132e8fc99768b0cc1e.jpg" alt="">通过这个，可以推导出上面的边界分布. 推导如下：<br>
<img src="/images/52nlp.cn/4dde39f1d7972ae3eede98f20eba946d.jpg" alt=""><br>
</span></span></p>
<p style="background: white"><span style="color: black;font-family: 微软雅黑;font-size: 9pt">上面就是用sum-product来求边缘分布的方法。<br>
不知道讲的是否明白，不明白就看书吧，一起研究<img src="/images/52nlp.cn/6998144da89ee64b53db7ed2ef38f45a.jpg" alt="">今天就讲到这了，大家有啥问题讨论下。<br>
huajh7(284696304) 21:34:52<br>
补充几点，一是 temporal model ,如Dynamical Bayesian newtwork(DBN), plate models ，这是图模型的表达能力; 二是belief Bropagation ，包括exact 和approximation ，loopy时的收敛性; Inference包括MCMC,变分法。这是图模型在tree和graph的推理能力。三是Structure Learning ，BIC score等。这是图模型的学习能力。</span></p>
<p>注：PRML读书会系列文章由 <a href="http://weibo.com/dmalgorithms">@Nietzsche_复杂网络机器学习</a> 同学授权发布，转载请注明原作者和相关的主讲人，谢谢。</p>
<p>PRML读书会讲稿PDF版本以及更多资源下载地址：<a href="http://vdisk.weibo.com/u/1841149974">http://vdisk.weibo.com/u/1841149974</a></p>
<p>本文链接地址：<a href="http://www.52nlp.cn/prml%E8%AF%BB%E4%B9%A6%E4%BC%9A%E7%AC%AC%E5%85%AB%E7%AB%A0-graphical-models">http://www.52nlp.cn/prml读书会第八章-graphical-models</a></p>

  </article>

  <div class="meta">

    <a class="basic-alignment left" href="/posts/2015/2015-01-31-prml%25e8%25af%25bb%25e4%25b9%25a6%25e4%25bc%259a%25e7%25ac%25ac%25e4%25b9%259d%25e7%25ab%25a0-mixture-models-and-em-a7767c4f3.html" title="Previous Post: PRML读书会第九章  Mixture Models and EM" data-instant>&laquo; PRML读书会第九章  Mixture Models and EM</a>

    <a class="basic-alignment right" href="/posts/2015/2015-01-31-prml%25e8%25af%25bb%25e4%25b9%25a6%25e4%25bc%259a%25e7%25ac%25ac%25e5%258d%2581%25e4%25b8%2580%25e7%25ab%25a0-sampling-methods-ed6b661c1.html" title="Next Post: PRML读书会第十一章  Sampling Methods" data-instant>PRML读书会第十一章  Sampling Methods &raquo;</a>

</div>
  <div id="related">
  <h2 class="subheader">Related Posts <small>They might be useful</small></h2>
  <ul class="posts">

      <li><span>07 Feb 2017</span> &raquo; <a href="http://iftti.com/posts/2017/2017-02-07-110052-111b13f41.html">研发团队 GIT 开发流程新人学习指南</a></li>

      <li><span>06 Feb 2017</span> &raquo; <a href="http://iftti.com/posts/2017/2017-02-06-110076-fcd8bd876.html">垃圾回收原来是这么回事</a></li>

      <li><span>06 Feb 2017</span> &raquo; <a href="http://iftti.com/posts/2017/2017-02-06-110072-cea0048e7.html">每天一个 Linux 命令（59）： rcp 命令</a></li>

  </ul>
</div>

<comments>

<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1936498"></script>
<!-- UY END -->

</comments>

</div>
      <!-- JiaThis Button BEGIN -->
<div class="jiathis_share_slide jiathis_share_24x24" id="jiathis_share_slide">
<div class="jiathis_share_slide_top" id="jiathis_share_title"></div>
<div class="jiathis_share_slide_inner">
<div class="jiathis_style_24x24">
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_googleplus"></a>
<a class="jiathis_button_twitter"></a>
<a class="jiathis_button_linkedin"></a>
<a class="jiathis_button_weixin"></a>
<a class="jiathis_button_cqq"></a>
<a class="jiathis_button_renren"></a>
<a class="jiathis_button_evernote"></a>
<a class="jiathis_button_pocket"></a>
<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'
	,slide:{
		divid:'wrap',
		pos:'left',
		gt:'true'
	}
};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1936498" charset="utf-8"></script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_slide.js" charset="utf-8"></script>
</div></div></div>
<!-- JiaThis Button END -->
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">IT技术干货</h2>

    <div class="footer-col-1 column">
      <p class="text">IT技术干货 KernelHacks 最好的技术站点 技术信息 纯干货</p>
      <ul>
        <li>汇集最好的科技与互联网信息</li>
        <li>Liu Lantao</li>
        <li><a href="mailto:iftti@iftti.com">iftti@iftti.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/Lax">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">Lax</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/liulantao">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">@liulantao</span>
          </a>
        </li>
        <li>
          <a href="https://plus.google.com/+LiuLantao">
            <span class="icon googleplus">
              <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                width="16px" height="16px" viewBox="0 0 134.658 131.646" enable-background="new 0 0 134.658 131.646"
                xml:space="preserve">
                <g>
                  <path fill="#C2C2C2" d="M126.515,4.109H8.144c-2.177,0-3.94,1.763-3.94,3.938v115.546c0,2.179,1.763,3.942,3.94,3.942h118.371
                  c2.177,0,3.94-1.764,3.94-3.942V8.048C130.455,5.872,128.691,4.109,126.515,4.109z"/>
                  <g>
                    <path fill="#FFFFFF" d="M70.479,71.845l-3.983-3.093c-1.213-1.006-2.872-2.334-2.872-4.765c0-2.441,1.659-3.993,3.099-5.43
                    c4.64-3.652,9.276-7.539,9.276-15.73c0-8.423-5.3-12.854-7.84-14.956h6.849l7.189-4.517H60.418
                    c-5.976,0-14.588,1.414-20.893,6.619c-4.752,4.1-7.07,9.753-7.07,14.842c0,8.639,6.633,17.396,18.346,17.396
                    c1.106,0,2.316-0.109,3.534-0.222c-0.547,1.331-1.1,2.439-1.1,4.32c0,3.431,1.763,5.535,3.317,7.528
                    c-4.977,0.342-14.268,0.893-21.117,5.103c-6.523,3.879-8.508,9.525-8.508,13.51c0,8.202,7.731,15.842,23.762,15.842
                    c19.01,0,29.074-10.519,29.074-20.932C79.764,79.709,75.344,75.943,70.479,71.845z M56,59.107
                    c-9.51,0-13.818-12.294-13.818-19.712c0-2.888,0.547-5.87,2.428-8.199c1.773-2.218,4.861-3.657,7.744-3.657
                    c9.168,0,13.923,12.404,13.923,20.382c0,1.996-0.22,5.533-2.762,8.09C61.737,57.785,58.762,59.107,56,59.107z M56.109,103.65
                    c-11.826,0-19.452-5.657-19.452-13.523c0-7.864,7.071-10.524,9.504-11.405c4.64-1.561,10.611-1.779,11.607-1.779
                    c1.105,0,1.658,0,2.538,0.111c8.407,5.983,12.056,8.965,12.056,14.629C72.362,98.542,66.723,103.65,56.109,103.65z"/>
                    <polygon fill="#FFFFFF" points="98.393,58.938 98.393,47.863 92.923,47.863 92.923,58.938 81.866,58.938 81.866,64.469
                    92.923,64.469 92.923,75.612 98.393,75.612 98.393,64.469 109.506,64.469 109.506,58.938"/>
                  </g>
                </g>
              </svg>
            </span>
            <span class="username">+LiuLantao</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">

<!--以下是QQ邮件列表订阅嵌入代码--><script >var nId = "6be92ef3590ee662cd5e6381ab2044c328716364f684cf3e",nWidth="auto",sColor="light",sText="填写您的邮件地址，订阅我们的精彩内容：" ;</script><script src="http://list.qq.com/zh_CN/htmledition/js/qf/page/qfcode.js" charset="gb18030"></script>

    </div>

  </div>

  <div class="wrap">
    <div>
      <a href="http://blog.liulantao.com">Blog</a> | <a href="http://1000bit.com">铅笔特评 1000bit</a> | <a href="http://visplanet.com">VisPlanet</a> | <a href="http://iftti.com">IT技术干货</a> | <a href="http://relax.org.cn">Relax</a> | <a href="http://hangzhou.io">杭州城市指南</a>
    </div>
  </div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1658815-7', 'iftti.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>

</footer>

    </body>
</html>