<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Erlang内存分配器之mbcs_pool | IT技术干货</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="IT技术干货 KernelHacks 最好的技术站点 技术信息 纯干货">
    <link rel="canonical" href="http://iftti.com/posts/2014/2014-04-27-3118-842c3fd13.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

</head>

    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">IT技术干货</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">

          <a class="page-link" href="/about/">About</a>

      </div>
    </nav>

  </div>

</header>

    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Erlang内存分配器之mbcs_pool</h1>
    <p class="meta"><span class="time">Apr 27, 2014</span><span class="source_url"> • 来自 yufeng.info <a name="yufeng.info" href="http://blog.yufeng.info/archives/3118" target="_blank">[原文链接]</a></span></p>
  </header>

  <article class="post-content">

			<div style="margin-top: 15px; font-style: italic">
<p><strong>原创文章，转载请注明：</strong> 转载自<a href="http://blog.yufeng.info/" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/', '系统技术非业余研究']);">系统技术非业余研究</a></p>
<p><strong>本文链接地址:</strong> <a href="http://blog.yufeng.info/archives/3118" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/archives/3118', 'Erlang内存分配器之mbcs_pool']);">Erlang内存分配器之mbcs_pool</a></p>
</div>
<p>Erlang R17.0 发布的release note 里面花了挺多笔墨讲了内存carrier迁移的特性：</p>
<blockquote>
<p>Support for migration of memory carriers between memory allocator instances has been introduced.<br>
By default this feature is not enabled and do not effect the characteristics of the system. When enabled it has the following impact on the characteristics of the system:</p>
<p>   * Reduced memory footprint when the memory load is unevenly distributed between scheduler specific allocator instances.<br>
   * Depending on the default allocaton strategy used on a specific allocator there might or might not be a slight performance loss.<br>
   * When enabled on the fix_alloc allocator, a different strategy for management of fix blocks will be used.<br>
   * The information returned from erlang:system_info({allocator, A}), and erlang:system_info({allocator_sizes, A}) will be slightly different when this feature has been enabled. An mbcs_pool tuple will be present giving information about abandoned carriers, and in the fix_alloc case no fix_types tuple will be present.</p>
<p>For more information, see the documentation of the +M acul command line argument.</p>
</blockquote>
<p>那么什么是”migration of memory carriers between memory allocator instances“，解决什么问题呢？<br>
官方的文档 erts/emulator/internal_doc/CarrierMigration.md, 见<a href="https://github.com/erlang/otp/blob/master/erts/emulator/internal_doc/CarrierMigration.md" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/erlang/otp/blob/master/erts/emulator/internal_doc/CarrierMigration.md', '这里']);">这里</a>, 已经描述的非常清楚了。<br>
<a href="http://blog.yufeng.info/wp-content/uploads/2014/04/allocators-1.png" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/wp-content/uploads/2014/04/allocators-1.png', '']);"><img src="/images/yufeng.info/45789a3ea6954e612b562fedfb69f260.jpg" alt="allocators-1" width="567" height="247" class="alignnone size-full wp-image-3128"></a><br>
我来简单的说下复述下：<br>
Erlang的内存分配器为了提高性能，每个调度器一个都有自己的内存池，在申请/释放内存的可以避免大量的锁争用，提高了性能。但也带来内存浪费的问题，首先调度器默认使用策略是“full load or not”, 也就是说低ID的调度器如果没饱和的话，不会用下一个调度器。在高负载的情况下，更多的调度器被启用，该调度器上的内存被缓冲，留在池子里。当工作负载下去的的话，因为压力没到，高ID的调度器没机会被使用，也就是说这个时候，这个调度器上的内存就浪费掉了，从整个VM的角度来看，内存的碎片率就很高。Erlang的VM是以稳定性著名的，但是它也有Crash的时候，十有八九是因为内存爆了。我们在设计系统的时候，通常从数据量去反推需要的内存，但是如果有碎片或者浪费存在严重的话，我们就无法准确，就可能导致灾难。 为了解决这个问题，最直接的反应就是当每个调度器池子里面的内存使用率低于一定程度的时候，就把该块内存出让出来，让有需要的调度器能够利用起来。这就是内存carriers迁移要解决的核心问题。</p>
<p>这个特性在R16加入的默认不启用，R17默认启用了，也就是说+M acul 默认是“de”. 带来的影响有下面几个：<br>
1. 内存申请的效率，现在的测试是先在自己的池子里面分配，不满足了就找cpool，再不满足才去找mseg或者sys分配器申请。效率和利用率是鱼和熊掌不可兼得。<br>
2. 内存分配器的内存除了在池子里面还有在cpool里，统计内存的时候要小心。<br>
3. 内存浪费率到什么时候被废弃。</p>
<p><span id="more-3118"></span><br>
我们先来看看acul参数的含义：</p>
<blockquote><p>+M acul <utilization>|de<br>
Abandon carrier utilization limit. A valid <utilization> is an integer in the range [0, 100] representing utilization in percent. When a utilization value larger than zero is used, allocator instances are allowed to abandon multiblock carriers. If de (default enabled) is passed instead of a <utilization>, a recomended non zero utilization value will be used. The actual value chosen depend on allocator type and may be changed between ERTS versions. Currently the default equals de, but this may be changed in the future. Carriers will be abandoned when memory utilization in the allocator instance falls below the utilization value used. Once a carrier has been abandoned, no new allocations will be made in it. When an allocator instance gets an increased multiblock carrier need, it will first try to fetch an abandoned carrier from an allocator instances of the same allocator type. If no abandoned carrier could be fetched, it will create a new empty carrier. When an abandoned carrier has been fetched it will function as an ordinary carrier. This feature has special requirements on the allocation strategy used. Currently only the strategies aoff, aoffcbf and aoffcaobf support abandoned carriers. This feature also requires multiple thread specific instances to be enabled. When enabling this feature, multiple thread specific instances will be enabled if not already enabled, and the aoffcbf strategy will be enabled if current strategy does not support abandoned carriers. This feature can be enabled on all allocators based on the alloc_util framework with the exception of temp_alloc (which would be pointless).
</utilization></utilization></utilization></p></blockquote>
<p>再从源码我们回到上面的几个问题：<br>
<a href="http://blog.yufeng.info/wp-content/uploads/2014/04/mbcs_pool_acul.png" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/wp-content/uploads/2014/04/mbcs_pool_acul.png', '']);"><img src="/images/yufeng.info/f91381991753ce87c711eb10feacdd31.jpg" alt="mbcs_pool_acul" width="555" height="366" class="alignnone size-full wp-image-3119"></a></p>
<p>我们知道当acul 设置成“de”, 也就是说default的时候<br>
<a href="http://blog.yufeng.info/wp-content/uploads/2014/04/mbcs_pool_acul_default.png" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/wp-content/uploads/2014/04/mbcs_pool_acul_default.png', '']);"><img src="/images/yufeng.info/ba6eb2a51d076b7a3b1435c9e7dfad56.jpg" alt="mbcs_pool_acul_default" width="440" height="57" class="alignnone size-full wp-image-3120"></a></p>
<p>这二段源码回答了release note里面“migration of memory carriers” 问题二和三。 问题一在CarrierMigration.md回答掉了。 那现在就剩下问题四需要回答下，这部分内存如何计算的。</p>
<pre class="brush: bash; title: ; notranslate" title="">
$ erl
Erlang/OTP 17 [erts-6.0.1] 1 [64-bit] [smp:16:16] [async-threads:10] [hipe] [kernel-poll:false]

Eshell V6.0.1  (abort with ^G)
1&gt; erlang:system_info({allocator, binary_alloc}).
...
 {instance,2,
           [{versions,"0.9","3.0"},
            {options,[{e,true},
                      {t,true},
                      {ramv,false},
                      {sbct,524288},
                      {asbcst,4145152},
                      {rsbcst,20},
                      {rsbcmt,80},
                      {rmbcmt,50},
                      {mmbcs,32768},
                      {mmmbc,18446744073709551615},
                      {mmsbc,256},
                      {lmbcs,5242880},
                      {smbcs,262144},
                      {mbcgs,10},
                      {acul,60},
                      {as,aoffcbf}]},
            {mbcs,[{blocks,0,0,0},
                   {blocks_size,0,0,0},
                   {carriers,1,1,1},
                   {mseg_alloc_carriers,0},
                   {sys_alloc_carriers,1},
                   {carriers_size,32928,32928,32928},
                   {mseg_alloc_carriers_size,0},
                   {sys_alloc_carriers_size,32928}]},
            {mbcs_pool,[{blocks,0},
                        {blocks_size,0},
                        {carriers,0},
                        {carriers_size,0}]},
            {sbcs,[{blocks,0,0,0},
                   {blocks_size,0,0,0},
                   {carriers,0,0,0},
                   {mseg_alloc_carriers,0},
                   {sys_alloc_carriers,0},
                   {carriers_size,0,0,0},
                   {mseg_alloc_carriers_size,0},
                   {sys_alloc_carriers_size,0}]},
            {calls,[{binary_alloc,0,0},
                    {binary_free,0,0},
                    {binary_realloc,0,0},
                    {mseg_alloc,0,0},
                    {mseg_dealloc,0,0},
                    {mseg_realloc,0,0},
                    {sys_alloc,0,1},
                    {sys_free,0,0},
                    {sys_realloc,0,0}]}]},
...
</pre>

<p>从R17的binary_alloc我们可以看出，输出里面多了个mbcs_pool信息，而且acul默认是60，也就是ERTS_ALC_DEFAULT_ENABLED_ACUL。</p>
<p>但是, 内存分配器的这些参数解读非常麻烦，一般的人看不懂。 之前的博文，我就介绍了<a href="http://blog.yufeng.info/archives/3080" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/archives/3080', 'recon']);">recon</a>, 其中的<a href="http://ferd.github.io/recon/recon_alloc.html" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://ferd.github.io/recon/recon_alloc.html', 'recon_alloc']);">recon_alloc</a>模块，就是用来帮用户解决这个问题的：</p>
<blockquote><p>Functions to deal with Erlang’s memory allocators, or particularly, to try to present the allocator data in a way that makes it simpler to discover possible problems.</p></blockquote>
<p>recon最近的版本就mbcs_pool做了很好的支持，”Include mbcs_pool in all mbcs values“, 参见 <a href="https://github.com/ferd/recon/commit/28daf8dc59883d2415ae42a54351df85ea0aa123" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/ferd/recon/commit/28daf8dc59883d2415ae42a54351df85ea0aa123', '这里']);">这里</a></p>
<p><a href="http://blog.yufeng.info/wp-content/uploads/2014/04/mbcs_pool_recon.png" onclick="_gaq.push(['_trackEvent', 'outbound-article-int', 'http://blog.yufeng.info/wp-content/uploads/2014/04/mbcs_pool_recon.png', '']);"><img src="/images/yufeng.info/07fbf40b17e1cc9ccd37ce8894bc6a1a.jpg" alt="mbcs_pool_recon" width="707" height="109" class="alignnone size-full wp-image-3121"></a></p>
<blockquote><p>
In R16B02 an option to enable a mbc pool was added. In order to<br>
get the total size of current mbcs we have to include the pool in<br>
all our calculations with mbcs.
</p></blockquote>
<p>有了recon_alloc的帮忙，再花点时间，你就可以非常清楚的知道你的VM内存使用的情况，避免内存使用的悲剧发生。</p>
<p>另外observer里面的crashdump_viewer.erl也把mbcs_pool的内存使用关注起来了，也更准确了。</p>
<p>祝玩的开心！</p>
<div style="margin-top: 0; margin-bottom: 15px; color: #888888; font-size: 80%; font-style: italic">
<p>Post Footer automatically generated by <a href="http://easwy.com/blog/wordpress/wp-posturl/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://easwy.com/blog/wordpress/wp-posturl/', 'wp-posturl plugin']);" style="color: #8888FF; text-decoration: underline;">wp-posturl plugin</a> for wordpress.</p>
</div>

			<div class="fixed"></div>

  </article>

  <div class="meta">

    <a class="basic-alignment left" href="/posts/2014/2014-04-26-the-noploop-cpu-benchmark.html-2dc1a1eab.html" title="Previous Post: The noploop CPU Benchmark" data-instant>&laquo; The noploop CPU Benchmark</a>

    <a class="basic-alignment right" href="/posts/2014/2014-04-27-3130-795c4778b.html" title="Next Post: Erlang公平调度的误解" data-instant>Erlang公平调度的误解 &raquo;</a>

</div>
  <div id="related">
  <h2 class="subheader">Related Posts <small>They might be useful</small></h2>
  <ul class="posts">

      <li><span>25 Jan 2017</span> &raquo; <a href="http://iftti.com/posts/2017/2017-01-25-109980-586c9687f.html">每天一个 Linux 命令（47）： iostat 命令</a></li>

      <li><span>25 Jan 2017</span> &raquo; <a href="http://iftti.com/posts/2017/2017-01-25-109832-8f41a380e.html">照顾好应用的缓存，应付大流量</a></li>

      <li><span>23 Jan 2017</span> &raquo; <a href="http://iftti.com/posts/2017/2017-01-23-109970-be7a95583.html">每天一个 Linux 命令（46）： vmstat 命令</a></li>

  </ul>
</div>

<comments>

<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1936498"></script>
<!-- UY END -->

</comments>

</div>
      <!-- JiaThis Button BEGIN -->
<div class="jiathis_share_slide jiathis_share_24x24" id="jiathis_share_slide">
<div class="jiathis_share_slide_top" id="jiathis_share_title"></div>
<div class="jiathis_share_slide_inner">
<div class="jiathis_style_24x24">
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_googleplus"></a>
<a class="jiathis_button_twitter"></a>
<a class="jiathis_button_linkedin"></a>
<a class="jiathis_button_weixin"></a>
<a class="jiathis_button_cqq"></a>
<a class="jiathis_button_renren"></a>
<a class="jiathis_button_evernote"></a>
<a class="jiathis_button_pocket"></a>
<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'
	,slide:{
		divid:'wrap',
		pos:'left',
		gt:'true'
	}
};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1936498" charset="utf-8"></script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_slide.js" charset="utf-8"></script>
</div></div></div>
<!-- JiaThis Button END -->
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">IT技术干货</h2>

    <div class="footer-col-1 column">
      <p class="text">IT技术干货 KernelHacks 最好的技术站点 技术信息 纯干货</p>
      <ul>
        <li>汇集最好的科技与互联网信息</li>
        <li>Liu Lantao</li>
        <li><a href="mailto:iftti@iftti.com">iftti@iftti.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/Lax">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">Lax</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/liulantao">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">@liulantao</span>
          </a>
        </li>
        <li>
          <a href="https://plus.google.com/+LiuLantao">
            <span class="icon googleplus">
              <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                width="16px" height="16px" viewBox="0 0 134.658 131.646" enable-background="new 0 0 134.658 131.646"
                xml:space="preserve">
                <g>
                  <path fill="#C2C2C2" d="M126.515,4.109H8.144c-2.177,0-3.94,1.763-3.94,3.938v115.546c0,2.179,1.763,3.942,3.94,3.942h118.371
                  c2.177,0,3.94-1.764,3.94-3.942V8.048C130.455,5.872,128.691,4.109,126.515,4.109z"/>
                  <g>
                    <path fill="#FFFFFF" d="M70.479,71.845l-3.983-3.093c-1.213-1.006-2.872-2.334-2.872-4.765c0-2.441,1.659-3.993,3.099-5.43
                    c4.64-3.652,9.276-7.539,9.276-15.73c0-8.423-5.3-12.854-7.84-14.956h6.849l7.189-4.517H60.418
                    c-5.976,0-14.588,1.414-20.893,6.619c-4.752,4.1-7.07,9.753-7.07,14.842c0,8.639,6.633,17.396,18.346,17.396
                    c1.106,0,2.316-0.109,3.534-0.222c-0.547,1.331-1.1,2.439-1.1,4.32c0,3.431,1.763,5.535,3.317,7.528
                    c-4.977,0.342-14.268,0.893-21.117,5.103c-6.523,3.879-8.508,9.525-8.508,13.51c0,8.202,7.731,15.842,23.762,15.842
                    c19.01,0,29.074-10.519,29.074-20.932C79.764,79.709,75.344,75.943,70.479,71.845z M56,59.107
                    c-9.51,0-13.818-12.294-13.818-19.712c0-2.888,0.547-5.87,2.428-8.199c1.773-2.218,4.861-3.657,7.744-3.657
                    c9.168,0,13.923,12.404,13.923,20.382c0,1.996-0.22,5.533-2.762,8.09C61.737,57.785,58.762,59.107,56,59.107z M56.109,103.65
                    c-11.826,0-19.452-5.657-19.452-13.523c0-7.864,7.071-10.524,9.504-11.405c4.64-1.561,10.611-1.779,11.607-1.779
                    c1.105,0,1.658,0,2.538,0.111c8.407,5.983,12.056,8.965,12.056,14.629C72.362,98.542,66.723,103.65,56.109,103.65z"/>
                    <polygon fill="#FFFFFF" points="98.393,58.938 98.393,47.863 92.923,47.863 92.923,58.938 81.866,58.938 81.866,64.469
                    92.923,64.469 92.923,75.612 98.393,75.612 98.393,64.469 109.506,64.469 109.506,58.938"/>
                  </g>
                </g>
              </svg>
            </span>
            <span class="username">+LiuLantao</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">

<!--以下是QQ邮件列表订阅嵌入代码--><script >var nId = "6be92ef3590ee662cd5e6381ab2044c328716364f684cf3e",nWidth="auto",sColor="light",sText="填写您的邮件地址，订阅我们的精彩内容：" ;</script><script src="http://list.qq.com/zh_CN/htmledition/js/qf/page/qfcode.js" charset="gb18030"></script>

    </div>

  </div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1658815-7', 'iftti.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>

</footer>

    </body>
</html>