<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>[火光摇曳]神奇的伽玛函数(下) | IT技术干货</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="IT技术干货 KernelHacks 最好的技术站点 技术信息 纯干货">
    <link rel="canonical" href="http://iftti.com/posts/2014/2014-07-01-e7-81-ab-e5-85-89-e6-91-87-e6-9b-b3-e7-a5-9e-e5-a5-87-e7-9a-84-e4-bc-bd-e7-8e-9b-e5-87-bd-e6-95-b0-e4-b8-8b-80f0c99be.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">IT技术干货</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
          
        
          <a class="page-link" href="/about/">About</a>
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>[火光摇曳]神奇的伽玛函数(下)</h1>
    <p class="meta"><span class="time">Jul 1, 2014</span><span class="source_url"> • 来自 52nlp.cn <a name="52nlp.cn" href="http://www.52nlp.cn/%e7%81%ab%e5%85%89%e6%91%87%e6%9b%b3%e7%a5%9e%e5%a5%87%e7%9a%84%e4%bc%bd%e7%8e%9b%e5%87%bd%e6%95%b0%e4%b8%8b" target="_blank">[原文链接]</a></span></p>
  </header>

  <article class="post-content">
  

						<p>原文链接： <a href="http://www.flickering.cn/?p=203">http://www.flickering.cn/?p=203</a></p>
<p><strong>五、$ \Gamma(n) = (n-1)!$ 还是 $ \Gamma(n) = n! $ ? </strong></p>
<p>伽玛函数找到了，我们来看看第二个问题，为何伽玛函数被定义为满足 $\Gamma(n)=(n-1)!$？ 这看起来挺别扭的，如果我们稍微修正一下，把伽玛函数定义中的 $t^{x-1}$ 替换为 $t^x$<br>
$$ \Gamma(x) = \int_0^{\infty} t^{x}e^{-t}dt , $$<br>
这不就可以使得 $\Gamma(n)=n!$了嘛。估计数学界每年都有学生问这个问题，然而答案却一直有一些争议。</p>
<p>欧拉最早的伽玛函数定义还真是如上所示，选择了$\Gamma(n)=n!$，事实上数学王子高斯在研究伽玛函数的时候， 一直使用的是如下定义：<br>
$$ \Pi(x)=\int_{0}^\infty t^x e^{-t}\,dt ,$$<br>
然而这个定义在历史上并没有流传开来。</p>
<p><img class="size-full wp-image-176 aligncenter" src="http://www.flickering.cn/wp-content/uploads/2014/06/Legendre.jpg" alt="Legendre" width="160" height="200"></p>
<p style="text-align: center;">勒让德肖像水彩画</p>
<p>欧拉在伽玛函数的推导中实际上引入了两类积分形式<br>
$$ \int_0^1 t^{x}(1-t)^{y}dt, \quad \quad \int_0^{\infty} t^{x}e^{-t}dt $$<br>
现在我们分别称为欧拉一类积分和欧拉二类积分。勒让德追随欧拉的脚步，发表了多篇论文对欧拉积分进行了深入的研究和推广，不过在勒让德的研究中，对积分中的参数做了 $-1$的移位修改，主要定义为<br>
$$ B(x, y) = \int_0^1 t^{x-1}(1-t)^{y-1}dt $$<br>
和<br>
$$ \Gamma(x) = \int_0^{\infty} t^{x-1}e^{-t}dt .$$<br>
$B(x,y)$ 现在称为贝塔积分或者贝塔函数。其中$\Gamma(x)$ 的这个定义选择导致了 $ \Gamma(n) = (n-1)!$ 。实际上伽马函数中的$\Gamma$符号历史上就是勒让德首次引入的，而勒让德给出的这个伽玛函数的定义在历史上起了决定作用，该定义被法国的数学家广泛采纳并在世界范围推广，最终使得这个定义在现代数学中成为了既成事实。<br>
<span id="more-6656"></span></p>
<p>什么原因驱使勒让德偏向选择$\Gamma(n) = (n-1)!$ 的定义呢？ 这成为了一个谜，没有明确的解释。 不过有数学史研究者们对欧拉的研究表明，在$1730\sim1768$ 年之间欧拉自己在研究一类积分的时候，实际上就已经对积分中的参数做了$-1$的移位修改，从而明确的引入了贝塔积分，而这个修改显然被勒让德注意到了。 是什么原因使得欧拉和勒让德在研究他们的积分形式的时候都考虑引入$-1$ 移位修改呢？ 有数学家猜测一个可能的原因是这两位数学家注意到，如果按照现代伽玛函数的定义，那么有<br>
\begin{equation}<br>
\label{beta-gamma-decompose}<br>
B(x,y) = \frac{\Gamma(x)\Gamma(y)}{\Gamma(x+y)} ,<br>
\end{equation}<br>
$B(x,y)$ 具有非常漂亮的对称形式。可是如果选取高斯给出的 $\Pi(n)=n!$ 的定义，令<br>
$$ E(x, y) = \int_0^1 t^{x}(1-t)^{y}dt $$<br>
则有<br>
$$ E(x,y) = \frac{\Pi(x)\Pi(y)}{\Pi(x+y+1)} ,$$<br>
这个形式显然不如 $B(x,y)$ 具有对称美，而数学家总是很在乎数学公式的美感的。</p>
<p>还有一个类似的解释是从抽象代数的角度提出的，考虑伽玛分布的概率密度函数<br>
$$ f_\alpha(x)= \left\{<br>
\begin{aligned}<br>
\frac{x^{\alpha-1} e^{-x}}{\Gamma(\alpha)} &amp; \text{for }x&gt;0<br>
\\ 0 \quad \quad &amp; \text{for }x &lt; 0<br>
\end{aligned}<br>
\right.<br>
$$<br>
形成的集合 $\{f_\alpha : \alpha &gt; 0\}$,那么该集合在卷积运算 $*$ 之下构成一个抽象代数中的半环，即满足<br>
$$ f_\alpha * f_\beta = f_{\alpha+\beta} .$$<br>
而用$\Pi(x)$ 的定义则无法得到类似的结果。</p>
<p>另外一个更具启发性的解释是也是从抽象代数角度描述的。 对伽玛函数<br>
$$ \Gamma(x) = \int_0^{\infty} e^{-t}t^{x-1}dt $$<br>
做一个线性变换 $h: t \rightarrow ct$，可以得到如下函数<br>
\begin{equation}<br>
\label{generalized-gamma}<br>
\frac{\Gamma(x)}{c^x} = \int_0^{\infty} e^{-ct} t^x \frac{dt}{t}<br>
\end{equation}<br>
由此 $dt/t = d \log t$ 可以被看成是乘法群 $(0, \infty)$ 上的一个不变测度，在尺度伸缩变换下满足不变性：<br>
$$ \frac{d(ct)}{ct} = \frac{dt}{t} .$$<br>
而 $e^{-ct}$ 对应于群上的一个加法特征(additive character) $f$， 满足<br>
$$f(t+s) =f(t) \cdot f(s) ,$$<br>
$t^x$ 对应于群上的一个乘法特征(mulpicative character) $g$， 满足<br>
$$g(t \cdot s) = g(t) \cdot g(s) .$$<br>
由于积分表示的是求和， 所以\eqref{generalized-gamma} 式 被看成是乘法群 $(0, \infty)$ 上加法特征和乘法特征混合乘积的累积求和。有了这个分解，只要在抽象代数的有限域上定义了$f$ 和$g$ 这两个映射， 实数域上定义的$\frac{\Gamma(x)}{c^x}$ 函数就可以被推广到有限域上进行定义，只是无限求和的积分号变成了有限求和符号$\Sigma$ 。 进一步，借用贝塔函数和伽玛函数满足的关系式\eqref{beta-gamma-decompose}, $Beta(x,y)$ 也可以完全类似的在有限域中定义出来， 而这种推广也将变得具有简洁的对称美。当然，这个理由和欧拉、勒让德的选择无关，而是现代数学家们给出的一个额外的解释。</p>
<p><strong>六、伽玛函数欣赏</strong></p>
<p>伽玛函数从它诞生开始就被许多数学家追逐研究，包括高斯、勒让德、威尔斯特拉斯、柳维尔等等，数学家们发现了这个函数大量的奇特性质，在解决许多数学问题的时候是一把利器。伽玛函数作为阶乘的推广，首先它也满足如下的斯特林公式<br>
$$ \Gamma(x) \approx \sqrt{2\pi}e^{-x}x^{x-\frac{1}{2}} .$$<br>
另外， 伽玛函数不仅可以定义在实数集上，基于复变函数的理论还可以延拓到整个复平面上。所以我们不仅可以计算$ (\frac{1}{2})!, (-7.5)!$，我们甚至可以计算 $(\frac{1}{2} + \frac{1}{3}i)!$，阶乘的概念居然可以推广到虚数，这真是太神奇了！</p>
<p style="text-align: center;"><a href="http://www.flickering.cn/wp-content/uploads/2014/06/gamma-complex.png"><img class="alignnone size-medium wp-image-209" src="http://www.flickering.cn/wp-content/uploads/2014/06/gamma-complex-300x216.png" alt="gamma-complex" width="300" height="216"></a></p>
<p style="text-align: center;">复平面上的伽玛函数</p>
<p>欧拉把$n!$ 推广之后得到了伽玛函数，很自然的一个问题是：伽玛函数是$n!$的唯一的插值推广函数吗？ 当然不是，丹尼尔·贝努利最早的无穷乘积推广就已经说明了存在多种推广延拓的方式。譬如$f(x) = \Gamma(x) \cos (2n\pi)$ 这个函数显然也满足把 $n!$ 延拓到实数集。 那伽玛函数在延拓 $n!$ 的时候有什么特殊的地方呢？ 从伽玛函数的图像我们可以看到它是一个凸函数，所以我们很自然地会问伽玛函数是否是唯一的满足凸性的阶乘函数，可是答案还是否定的。 那伽马函数为什么鹤立鸡群呢？数学家们发现不仅 $\Gamma(x)$ 是一个凸函数， $\log\Gamma(x)$ 也是一个凸函数，数学上可以证明如下定理:</p>
<p><strong>[Bohr-Mullerup 定理]</strong> 如果 $f:(0,\infty)\rightarrow (0,\infty)$,且满足</p>
<ol>
<li> $f(1) = 1$</li>
<li> $f(x+1) = xf(x)$</li>
<li> $\log f(x)$ 是凸函数</li>
</ol>
<p>那么 $f(x) = \Gamma(x)$, 也就是 $\Gamma(x)$是唯一满足以上条件的函数。</p>
<p style="text-align: center;"><a href="http://www.flickering.cn/wp-content/uploads/2014/06/digamma-func.png"><img class="alignnone size-medium wp-image-208" src="http://www.flickering.cn/wp-content/uploads/2014/06/digamma-func-300x233.png" alt="digamma-func" width="300" height="233"></a><br>
\$\log \Gamma(x)$ 是一个凸函数</p>
<p>伽玛函数有不少等价的表示形式和神奇的结果。高斯给出的伽玛函数的形式是<br>
$$ \Gamma(x) = \lim_{n\rightarrow\infty} \frac{n^x n!}{x(x+1)(x+2)\cdots(x+n)} .$$<br>
欧拉证明了如下一个漂亮的反射公式<br>
$$ \Gamma(x) \Gamma(1-x) = \frac{\pi}{\sin (\pi x)} .$$<br>
维尔斯特拉斯把高斯的伽玛函数形式做一下变换，就得到如下表达为无穷乘积的结果<br>
$$ {\Gamma(x)} = \frac{1}{xe^{\gamma x}} \prod_{k=1}^\infty<br>
\frac{e^{\frac{x}{k}}} {1+\frac{x}{k}} .$$<br>
此处 $\gamma = 0.5772156649\cdots$ 为欧拉常数。这个结果在复平面上也成立。由于伽玛函数的这个分解形式的启发，导致维尔斯特拉斯发现复平面上任意整函数$f(z)$ 都以分解为无穷乘积形式。基于维尔斯特拉斯的这个无穷乘积形式和欧拉的反射公式，分别整理简化一下 $\Gamma(1+x)\Gamma(1-x)$，就可以轻松地得到介绍沃利斯公式的时候中提到的 $\sin x$ 的无穷乘积展开式。</p>
<p>伽玛函数还有很多妙用，它能扩展一些重要的数学概念，譬如导数。我们可以定义一阶、二阶等整数阶导数，所以一个自然的问题是：我们能定义分数阶的导数吗？ 这个问题早年莱布尼茨研究微积分的时候他就提出来过，然而没有获得实质性进展。而欧拉给出了伽玛函数之后，也研究过分数阶导数的问题。我们观察一下函数$f(x) = x^n$ 的各阶导数</p>
<p><a href="http://www.flickering.cn/wp-content/uploads/2014/06/derivatives.png"><img class="wp-image-216  aligncenter" src="http://www.flickering.cn/wp-content/uploads/2014/06/derivatives-1024x420.png" alt="derivatives" width="524" height="215"></a></p>
<p>由于k阶导数可以用阶乘表达，于是我们用伽玛函数表达为<br>
$$ f(x)^{(k)} = \frac{\Gamma{(n+1)}}{\Gamma{(n-k+1)}} x^{n-k} $$<br>
基于上式，可以把导数的阶从整数延拓到实数集。例如，取$n=1, k=\frac{1}{2}$ 我<br>
们可以计算 $x$ 的 $\frac{1}{2}$阶导数为<br>
$$ f(x)^{(\frac{1}{2})} = \frac{\Gamma{(1+1)}}{\Gamma{(1-1/2+1)}} x^{1-1/2}<br>
= \frac{2\sqrt{x}}{\sqrt{\pi}} .$$<br>
很容易想到对于一般的函数 $f(x)$ 通过泰勒级数展开可以表达为幂级数，于是借用 $x^n$ 的分数阶导数，我们可以尝试定义出任意函数的分数阶导数。不过有点遗憾的是这种简单的基于泰勒级数的定义方法不是良定义的，并非对所有函数都适用，但是这个思想却给后来的数学家提供了重要的线索，并由此发展了数学分析中的一个研究课题： Fractional Calculus。 在这种微积分中，分数阶的导数是具有良定义的，而积分作为导数的逆运算，也可以有分数阶。 这听起来真是很神奇，而这一切都要归功于伽玛函数。</p>
<p style="text-align: center;"><a href="http://www.flickering.cn/wp-content/uploads/2014/06/n-dim-ball.jpg"><img class="size-medium wp-image-177 aligncenter" src="http://www.flickering.cn/wp-content/uploads/2014/06/n-dim-ball-300x200.jpg" alt="n-dim-ball" width="300" height="200"></a><br>
n 维球的体积</p>
<p>伽马函数还有一个奇妙的运用是求高维空间中球的体积。我们知道 二维球是圆；其面积为 $\pi r^2$，三维球的体积为 $\frac{4}{3} \pi r^3$，那$n$维空间中半径为$r$的球的体积如何计算呢？ 数学上这个体积应该是如下多重积分<br>
$$ \displaystyle V_n(r) = \idotsint\limits_{ \tiny \{(x_1, \cdots, x_n) | \sum x_i^2 &lt; r^2 \} } 1 \quad dx_1dx_2 \cdots dx_n $$<br>
可以证明<br>
$$ V_n(r) = \frac{\pi^{\frac{n}{2}} r^n}{\Gamma(\frac{n}{2} + 1)} .$$</p>
<p>下面我们来说一说伽玛函数和数论的关系。 伽玛函数和欧拉常数$\gamma$ 有密切关系，可以发现<br>
$$ \gamma = -\frac{d\Gamma(x)}{dx}|_{x=1} =<br>
\lim_{n\rightarrow \infty}(1+\frac{1}{2} + \frac{1}{3}+\cdots+\frac{1}{n} – \log n) $$<br>
欧拉常数$\gamma$ 是一个神奇的常数，数学家们至今也没搞清楚它是一个有理数还是一个无理数。进一步还可以发现伽玛函数和黎曼$\zeta(s)$函数<br>
$$ \zeta(s) = 1+\frac{1}{2^s} + \frac{1}{3^s} + \cdots $$<br>
有密切联系，黎曼发现了如下式子<br>
$$ \zeta(x) \Gamma(x) = \int_0^\infty \frac{u^{x-1}}{e^u – 1} du ,$$<br>
$$ \zeta(x) = \zeta(1-x) \Gamma(1-x) 2^s \pi^{s-1} \sin\left(\frac{\pi x}{2}\right) .$$<br>
$\zeta$ 函数在解析数论中可是有着举足轻重的地位，因为它涉及了数学中著名的素数分布定理和黎曼猜想，而以上两个式子在分析黎曼猜想过程中有重要作用。数学家蒙哥马利有一句名言：“假如你是一个魔鬼，引诱数学家用自己的灵魂来换取一个定理的证明。多数数学家会想要换取的会是什么定理呢，我想会是黎曼猜想。” 而希尔伯特曾说过，如果他在沉睡1000年后醒来, 他将问的第一个问题便是：黎曼猜想得到证明了吗？</p>
<p>前面提到了 $\log\Gamma(x)$ 是一个凸函数。对这个函数求导得到的函数<br>
$$ \Psi(x) = \frac{d\log\Gamma(x)}{dx} $$<br>
被称为 Digamma 函数，可以证明<br>
$$\Psi(x) = -\gamma + (x-1) – \frac{(x-1)(x-2)}{2\cdot 2!}<br>
+ \frac{(x-1)(x-2)(x-3)}{3\cdot 3!} \cdots $$<br>
这也是一个很重要的函数，具有如下一个漂亮的性质<br>
$$ \Psi(x+1) = \Psi(x) + \frac{1}{x} .$$<br>
函数$\Psi(x)$和欧拉常数$\gamma$ 以及 $\zeta$ 函数都有密切关系，令<br>
$$ \Psi_n(x) = \frac{d^{n+1}\log\Gamma(x)}{dx^{n+1}} ,$$<br>
可以证明<br>
$$\Psi_1(x) = \frac{d^{2}\log\Gamma(x)}{dx^{2}}<br>
= \frac{1}{x^2} + \frac{1}{(x+1)^2} + \frac{1}{(x+2)^2} + \cdots .$$<br>
对于几个具体的数值，有如下漂亮的结果<br>
$$\Psi(1) = -\gamma, \quad \quad \Psi(2) = 1-\gamma $$<br>
$$\Psi_1(1) = \zeta(2) = 1 + \frac{1}{2^2} + \frac{1}{3^2} + \frac{1}{4^2} + \cdots<br>
= \frac{\pi^2}{6} $$</p>
<p><strong>七、随机数学中的伽马函数</strong></p>
<p>伽玛函数在概率统计中频繁现身，众多的统计分布，包括常见的统计学三大分布($t$ 分布，$\chi^2$ 分布，$F$ 分布)、贝塔分布、狄利克雷分布的密度公式中都有伽玛函数的身影。当然发生最直接联系的概率分布是直接由伽玛函数变换得到的伽玛分布。对伽玛函数的定义做一个变形，就可以得到如下式子<br>
$$ \int_0^{\infty} \frac{x^{\alpha-1}e^{-x}}{\Gamma(\alpha)}dx = 1 .$$<br>
于是，取积分中的函数作为概率密度，就得到一个形式最简单的伽玛分布的密度函数<br>
$$Gamma(x|\alpha) = \frac{x^{\alpha-1}e^{-x}}{\Gamma(\alpha)} .$$<br>
如果做一个变换 $x=\beta t$, 就得到伽玛分布的更一般的形式<br>
$$Gamma(t|\alpha, \beta) = \frac{\beta^\alpha t^{\alpha-1}e^{-\beta t}}{\Gamma(\alpha)} .$$</p>
<p style="text-align: center;"><a href="http://www.flickering.cn/wp-content/uploads/2014/06/gamma-distribution.png"><img class="alignnone size-medium wp-image-210" src="http://www.flickering.cn/wp-content/uploads/2014/06/gamma-distribution-300x228.png" alt="gamma-distribution" width="300" height="228"></a><br>
$Gamma(t|\alpha,\beta)$分布图像</p>
<p>伽玛分布在概率统计领域也是一个万人迷，众多统计分布和它有密切关系。指数分布和 $\chi^2$ 分布都是特殊的伽玛分布。另外伽玛分布是一个很强大的先验分布，在贝叶斯统计分析中被广泛的用作其它分布的先验。如果把统计分布中的共轭关系类比为人类生活中的情侣关系的话，那指数分布、泊松分布、正态分布、对数正态分布都可以是伽玛分布的情人。</p>
<p>接下来的内容中我们主要关注$\beta = 1$的简单形式的伽玛分布。伽玛分布首先和泊松分布发生密切的联系。我们容易发现伽玛分布的概率密度和泊松分布在数学形式上具有高度的一致性。参数为$\lambda$的泊松分布，概率写为<br>
$$Poisson(X=k|\lambda) = \frac{\lambda^k e^{-\lambda}}{k!} $$<br>
在伽玛分布的密度中取 $\alpha = k+1$ 得到<br>
$$ Gamma(\lambda|\alpha=k+1)<br>
= \frac{\lambda^ke^{-\lambda}}{\Gamma(k+1)}= \frac{\lambda^k e^{-\lambda}}{k!} $$<br>
所以这两个分布的数学形式具有高度的一致性，只是泊松分布是离散的，伽玛分布是连续的。这种数学上的一致性是偶然的吗？ 事实上，从泊松分布出发，可以利用一个简单的概率物理模型对伽玛分布的密度函数给出清晰的解释。</p>
<p>泊松分布可以用于描述一段时间内事件发生次数的统计性质，譬如接到的电话的次数。假设我们关心的不是一段有限的时间，而是 $(0, \infty)$ 整个时间轴上接到电话的统计性质，应该如何来描述呢？我们可以假设接到的电话满足如下性质</p>
<ol>
<li>概率在时间轴是独立均匀分布的，即每个等长的时间区间上是否接到电话是独立的，并且概率分布一样；每一个长度为h的充分小的时间片上接到一个电话的概率正比于时间片的长度；</li>
<li>每一个充分小时间片上最多只能接到一个电话。</li>
<li>平均而言，假设每个长度为1的单位时间片上接到电话个数是1；</li>
</ol>
<p>如果我们考察 $[0, \lambda]$ 这个时间区间，那么平均而言，这个长度为 $\lambda$ 的时间片上应该接到 $\lambda$ 个电话，把这个时间区间分成 $n$ 个独立的小片，那么每个时间片上接到一个电话的概率恰好是 $p = \lambda/n$。当$n$ 足够大的时候，每个时间片上只能是接到一个电话或者没有接到电话，恰好对应于成功概率为$p$ 的一个贝努利实验，于是$n$ 个时间片对应于$n$ 个独立的贝努利实验，所以 $[0, \lambda]$这个时间区间上接到的电话总数$X$ 应该符合二项分布<br>
$$p(X=k) = \binom{n}{k} p^k(1-p)^{n-k} .$$<br>
由于 $np= \lambda$, 于是 $n$ 趋向于无穷的时候，粒子个数$X$将满足参数为<br>
$\lambda$ 的泊松分布<br>
$$p(X=k) = \frac{\lambda^k e^{-\lambda}}{k!} .$$</p>
<p>熟悉随机过程理论的读者马上会发现以上模型实际上是参数为1 的泊松过程。 我们关心的问题是：什么时候会接到第${k+1}$ 个电话？或者说接到第$k+1$ 个电话的时间点 $Y_{k+1}$ 会是什么概率分布？ 形式化的描述就是如何计算如下的概率？<br>
$$ P(\lambda &lt; Y_{k+1} \le \lambda + d\lambda) = ? $$<br>
上式表明第$k+1$ 个电话落在长度为 $d\lambda$ 的区间 $(\lambda, \lambda + d\lambda] $ 内，这个概率事件可以分解为两个独立事件</p>
<ol>
<li>区间 $(\lambda, \lambda + d\lambda] $ 内接到一个电话，这个概率是 $d \lambda$</li>
<li>区间 $[0, \lambda]$ 内接到了前$k$ 个电话，这个概率是 <span style="line-height: 1.5;">$$ p(X=k) = \frac{\lambda^k e^{-\lambda}}{k!} .$$</span>
</li>
</ol>
<p>于是所求的概率是以上两个事件概率相乘，即<br>
$$ P(\lambda &lt; Y_{k+1} \le \lambda + d\lambda) = p(X=k) \cdot d \lambda .$$<br>
由于第$k+1$ 个电话必然出现在时间轴上某处，所以把时间轴所有无穷小区间上的概率累加起来，正好对应于必然事件的概率1，所以有<br>
$$ \int_0^\infty p(X=k) \cdot d \lambda = 1 $$ 把$P(X=k)$ 带入上式即可得到<br>
$$ \int_0^\infty \frac{\lambda^k e^{-\lambda}}{k!} d \lambda = 1 $$<br>
$$ k! = \int_0^\infty \lambda^k e^{-\lambda} d \lambda $$<br>
上述两式整好就对应于伽玛分布和伽玛函数。所以$Y_{k+1}$ 恰好符合伽玛分布。 我们其实从泊松分布出发，完全基于概率物理模型，推导出了伽玛函数，而推导的过程也同时给伽玛分布的密度函数提供了物理解释。</p>
<p>如果我们把伽玛函数和$e^\lambda$的泰勒展开式对照写成如下形式<br>
\begin{align} e^\lambda &amp; = \sum_{k=0}^{\infty} {\lambda^k \over k!} \\<br>
k! &amp; = \int_0^{\infty} {\lambda^k \over e^\lambda}\ d\lambda.<br>
\end{align}<br>
我们发现这两个式子形式上具有对偶关系。由于 $\sum$ 和$\int$ 都表示求和， 几乎可以认为从第一个式子只是把 $e^\lambda$ 和 $k!$ 交换一下就得到了第二个式子。 这两个式子之间有更多的内在联系吗？事实上有如下一个奇妙的等式成立 \begin{equation} \label{gamma-e-taylor} \frac{1}{k!} \int_0^\lambda \frac{\lambda^k}{e^\lambda} d\lambda + \frac{1}{e^\lambda} \sum_{n=0}^k \frac{\lambda^n}{n!} = 1<br>
\end{equation}<br>
用上面描述的泊松过程的物理模型，可以很容易的证明这个等式。我们把数轴分成 $(0, \lambda]$ 和 $(\lambda, \infty)$ 这两个区间，考察第$k+1$ 个电话接到时间 $Y_{k+1}$ 分别落在这两个区间的概率，当然有 $$ P(Y_{k+1} \le \lambda) + P(Y_{k+1} &gt; \lambda) = 1 $$<br>
按照上述的物理模型，显然第$k+1$ 个电话的时间落入$(0, \lambda]$ 的概率为<br>
$$ P(Y_{k+1} \le \lambda) = \int_0^\lambda \frac{\lambda^k e^{-\lambda}}{k!} d \lambda $$<br>
如果第$k+1$ 个电话的时间点落入 $(\lambda, \infty)$，这个事件等价地可以理解为 $(0, \lambda]$ 上的电话个数不能超过 $k$ 个，由于$(0, \lambda]$ 这个有限时间区间上的电话次数符合参数为$\lambda$ 的泊松分布， 所以这个概率为<br>
$$ P(Y_{k+1} &gt; \lambda) = \sum_{n=0}^k \frac{\lambda^n e^{-\lambda} }{n!} $$<br>
所以我们得到<br>
\begin{equation}<br>
\label{poisson-gamma-dual}<br>
\int_0^\lambda \frac{\lambda^k e^{-\lambda}}{k!}d\lambda<br>
+ \sum_{n=0}^k \frac{\lambda^n e^{-\lambda}}{n!} = 1<br>
\end{equation}<br>
这个式子俗称泊松-伽玛对偶，简单整理一下就是 \eqref{gamma-e-taylor} 式。</p>
<p>由于泊松分布可以看做是二项分布的极限分布，所以我们也可以从二项分布的角度对伽马分布进行解释。由于<br>
$$ e^{-\lambda} = \lim_{n\rightarrow \infty} (1- \frac{\lambda}{n}) ^n $$<br>
所以伽马分布的概率密度可以重写为<br>
\begin{align*}<br>
\frac{\lambda^k e^{-\lambda}}{k!}<br>
&amp; = \lim_{n\rightarrow \infty} \frac{\lambda^k (1-\frac{\lambda}{n}) ^n}{k!} \\<br>
&amp; = \lim_{n\rightarrow \infty} \frac{ n! n^k (\frac{\lambda}{n})^k (1-\frac{\lambda}{n}) ^n}{k! \cdot n!} \\<br>
&amp; = \lim_{n\rightarrow \infty} \frac{(n+k)!}{k!\cdot n!} (\frac{\lambda}{n})^k (1-\frac{\lambda}{n}) ^n \\<br>
&amp; = \lim_{n\rightarrow \infty} \binom{n+k}{k} (\frac{\lambda}{n})^k (1-\frac{\lambda}{n}) ^n<br>
\end{align*}<br>
显然上式具有明确的二项分布的物理含义。事实上，二项分布和贝塔分布之间也存在完全类似\eqref{poisson-gamma-dual} 的一个等式：<br>
\begin{equation}<br>
\label{binomial-beta-dual}<br>
\frac{n!}{k!(n-k-1)!} \int_0^p t^k(1-t)^{n-k-1} dt + \sum_{v=0}^k \binom{n}{v} p^v(1-p)^{n-v} = 1<br>
\end{equation}<br>
如果我们知道$n\rightarrow\infty$时上式中二项分布的极限是泊松分布，而贝塔分布的极限是伽玛分布，那么就很容易理解 \eqref{poisson-gamma-dual} 其实可以看做是 \eqref{binomial-beta-dual} 的极限形式。</p>
<p><strong>八、结语</strong></p>
<p>作家海明威说：“冰山运动之雄伟壮观，是因为它只有八分之一在水面上。”阶乘，这么一个简单的基于整数的数学概念，俨然是一座冰山，我们日常看到的只是它浮在水面上的一角。而数学家们眼光犀利，看出这座山并非只有整数的一角，他们逐步地深入挖掘探索，挖出了神奇的伽马函数，把深藏在冰山下的实数域、复数域、甚至有限域都给挖了出来。而挖掘出来的伽玛函数真是一个魔术师，它跨越了人们的直觉想象，使得许多数学概念能够神奇地从整数延拓到分数；而伽玛函数同时又在现代数学的各个分支中表演着自己的神奇技艺。有许多人认为数学的概念是静态的：这些数学概念产生于历史上某一个时刻，某一位数学大家之手，之后就几乎一成不变了。对于大多数非数学专业的人而言，这种感觉貌似很自然，毕竟普通读者所接触的几何、代数、微积分这些数学知识都已经体系成熟，存在了几百甚至上千年。 然而数学的发展其实是先有探索的阶段，然后才有逻辑与体系，只是我们的数学课本历来偏重后者而忽视前者。而如果我们对数学知识的探索过程有所了解的话，会发现这些探索也犹如冰山掩藏在水面之下的部分，甚至比露出的尖角还更具魅力。</p>
<p>台湾的数学教授蔡聪明先生在数学的科普传播方面写过大量的文章，他在《数学的发现趣谈》一书中对于数学的创造、发现与发展有一段精彩的论述：“如果你不知道一个定理（或公式）是怎样发现的，那么你对它并没有真正的了解，因为真正的了解必须从逻辑因果掌握到创造的心理因果。一个定理的诞生，基本上跟一粒种子在适当的土壤、风雨、阳光、气候 … 之下，发芽成一颗树，再开花结果，并没有两样。”本文尝试尽可能的呈现伽玛函数这颗数学之树的生长历程，可以说伽玛函数的种子最早是沃利斯播下的，欧拉给予了最好的施肥、灌溉使得种子发芽，而后来众多数学家们的努力使得这颗嫩芽茁壮成长，最终几乎成长为一颗参天大树。</p>
<p>伽玛函数这颗大树在现代数学中如此繁茂，笔者知识有限仅能描绘它很有限的一部分。这个函数在数学上魅力独特，不仅能够被一个理科本科生很好的理解，它本身又足够的深刻，具有很多漂亮的数学性质，历史上吸引了众多一流的数学家对它进行探索研究。美国数学家 Philip J.Davis 在1959年在《美国数学月刊》上发表了一篇很有名的介绍伽玛函数的文章，文中对伽玛函数一些特性发现的历史进行了详细的描述，这篇文章获得了 Chauvenet Prize (美国数学会颁发的数学科普奖)。 他在文中最后总结道：</p>
<p><em>Each generation has found something of interest to say about the gamma function. Perhaps the next generation will also. (每一代人都发现了一些伽马函数的有趣性质，也许下一代人也会有所发现。)</em><br>
—Philip J.Davis</p>
<p><strong>九、推荐阅读</strong><br>
如果希望了解更多阶乘研究以及伽玛函数相关的历史，推荐阅读如下文献：</p>
<ul>
<li>蔡聰明, 瓦里斯尋$\pi$ 的發現理路,科学月刊, 27(4) 1996</li>
<li>蔡聰明, 瓦里斯公式及其相關的結果,科学月刊, 27(5), 1996</li>
<li>蔡聰明, 談 Stirling 公式, 数学传播 , 17(2), 1993</li>
<li>Philip J. Davis, Leonhard Euler’s Integral: A Historical Profile of the Gamma Function, The American Mathematical Monthly, vol. 66, pp. 849-869, 1959</li>
<li>Jacques Dutka, The Early History of the Factorial Function, Archive for History of Exact Sciences, 43 (3), pp. 225-249, 1991</li>
<li>Detlef Gronnau, Why is the gamma function so as it is?, Teaching Mathematics and Computer Science, 2003</li>
<li>Emil Artin, The Gamma function(English Traslation), Holt, Rinehart and Winston, Inc., 1964</li>
<li>George E. Andrews et al., Special Functions, Cambridge University Press, 2001</li>
<li>Ian Tweddle, James Stirling’s Methodus Differentialis: An Annotated Translation of Stirling’s Text, Springer, 2003</li>
</ul>
<p><a href="http://www.flickering.cn"><img class="aligncenter" src="http://www.flickering.cn/logo/flickering-logo.png" alt="火光摇曳" width="201" height="213"></a></p>

											


  </article>

  <div class="meta">
  
    <a class="basic-alignment left" href="/posts/2014/2014-06-30-e7-a5-9e-e5-a5-87-e7-9a-84-e4-bc-bd-e7-8e-9b-e5-87-bd-e6-95-b0-e4-b8-8a-d49d593f9.html" title="Previous Post: [火光摇曳]神奇的伽玛函数(上)" data-instant>&laquo; [火光摇曳]神奇的伽玛函数(上)</a>
  
  
    <a class="basic-alignment right" href="/posts/2014/2014-07-01-perf-heat-maps.html-c6f782733.html" title="Next Post: perf Heat Maps" data-instant>perf Heat Maps &raquo;</a>
  
</div>
  <div id="related">
  <h2 class="subheader">Related Posts <small>They might be useful</small></h2>
  <ul class="posts">
    
      <li><span>14 May 2018</span> &raquo; <a href="http://iftti.com/posts/2018/2018-05-14-113985-6dc6e9281.html">给初学者看的 shuf 命令教程</a></li>
    
      <li><span>13 May 2018</span> &raquo; <a href="http://iftti.com/posts/2018/2018-05-13-113977-b56537dc0.html">常用排序算法总结（2）</a></li>
    
      <li><span>13 May 2018</span> &raquo; <a href="http://iftti.com/posts/2018/2018-05-13-113953-957e4ea5a.html">10 个常用的软件架构模式</a></li>
    
  </ul>
</div>

  
<comments>

<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1936498"></script>
<!-- UY END -->

</comments>

</div>
      <!-- JiaThis Button BEGIN -->
<div class="jiathis_share_slide jiathis_share_24x24" id="jiathis_share_slide">
<div class="jiathis_share_slide_top" id="jiathis_share_title"></div>
<div class="jiathis_share_slide_inner">
<div class="jiathis_style_24x24">
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_googleplus"></a>
<a class="jiathis_button_twitter"></a>
<a class="jiathis_button_linkedin"></a>
<a class="jiathis_button_weixin"></a>
<a class="jiathis_button_cqq"></a>
<a class="jiathis_button_renren"></a>
<a class="jiathis_button_evernote"></a>
<a class="jiathis_button_pocket"></a>
<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'
	,slide:{
		divid:'wrap',
		pos:'left',
		gt:'true'
	}
};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1936498" charset="utf-8"></script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_slide.js" charset="utf-8"></script>
</div></div></div>
<!-- JiaThis Button END -->
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">IT技术干货</h2>

    <div class="footer-col-1 column">
      <p class="text">IT技术干货 KernelHacks 最好的技术站点 技术信息 纯干货</p>
      <ul>
        <li>汇集最好的科技与互联网信息</li>
        <li>Liu Lantao</li>
        <li><a href="mailto:iftti@iftti.com">iftti@iftti.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/Lax">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">Lax</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/liulantao">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">@liulantao</span>
          </a>
        </li>
        <li>
          <a href="https://plus.google.com/+LiuLantao">
            <span class="icon googleplus">
              <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                width="16px" height="16px" viewBox="0 0 134.658 131.646" enable-background="new 0 0 134.658 131.646"
                xml:space="preserve">
                <g>
                  <path fill="#C2C2C2" d="M126.515,4.109H8.144c-2.177,0-3.94,1.763-3.94,3.938v115.546c0,2.179,1.763,3.942,3.94,3.942h118.371
                  c2.177,0,3.94-1.764,3.94-3.942V8.048C130.455,5.872,128.691,4.109,126.515,4.109z"/>
                  <g>
                    <path fill="#FFFFFF" d="M70.479,71.845l-3.983-3.093c-1.213-1.006-2.872-2.334-2.872-4.765c0-2.441,1.659-3.993,3.099-5.43
                    c4.64-3.652,9.276-7.539,9.276-15.73c0-8.423-5.3-12.854-7.84-14.956h6.849l7.189-4.517H60.418
                    c-5.976,0-14.588,1.414-20.893,6.619c-4.752,4.1-7.07,9.753-7.07,14.842c0,8.639,6.633,17.396,18.346,17.396
                    c1.106,0,2.316-0.109,3.534-0.222c-0.547,1.331-1.1,2.439-1.1,4.32c0,3.431,1.763,5.535,3.317,7.528
                    c-4.977,0.342-14.268,0.893-21.117,5.103c-6.523,3.879-8.508,9.525-8.508,13.51c0,8.202,7.731,15.842,23.762,15.842
                    c19.01,0,29.074-10.519,29.074-20.932C79.764,79.709,75.344,75.943,70.479,71.845z M56,59.107
                    c-9.51,0-13.818-12.294-13.818-19.712c0-2.888,0.547-5.87,2.428-8.199c1.773-2.218,4.861-3.657,7.744-3.657
                    c9.168,0,13.923,12.404,13.923,20.382c0,1.996-0.22,5.533-2.762,8.09C61.737,57.785,58.762,59.107,56,59.107z M56.109,103.65
                    c-11.826,0-19.452-5.657-19.452-13.523c0-7.864,7.071-10.524,9.504-11.405c4.64-1.561,10.611-1.779,11.607-1.779
                    c1.105,0,1.658,0,2.538,0.111c8.407,5.983,12.056,8.965,12.056,14.629C72.362,98.542,66.723,103.65,56.109,103.65z"/>
                    <polygon fill="#FFFFFF" points="98.393,58.938 98.393,47.863 92.923,47.863 92.923,58.938 81.866,58.938 81.866,64.469
                    92.923,64.469 92.923,75.612 98.393,75.612 98.393,64.469 109.506,64.469 109.506,58.938"/>
                  </g>
                </g>
              </svg>
            </span>
            <span class="username">+LiuLantao</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">
      
<!--以下是QQ邮件列表订阅嵌入代码--><script >var nId = "6be92ef3590ee662cd5e6381ab2044c328716364f684cf3e",nWidth="auto",sColor="light",sText="填写您的邮件地址，订阅我们的精彩内容：" ;</script><script src="http://list.qq.com/zh_CN/htmledition/js/qf/page/qfcode.js" charset="gb18030"></script>

    </div>

  </div>

  <div class="wrap">
    <div>
      <a href="http://blog.liulantao.com">Blog</a> | <a href="http://1000bit.com">铅笔特评 1000bit</a> | <a href="http://visplanet.com">VisPlanet</a> | <a href="http://iftti.com">IT技术干货</a> | <a href="http://relax.org.cn">Relax</a> | <a href="http://hangzhou.io">杭州城市指南</a>
    </div>
  </div>

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1658815-7', 'iftti.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>


</footer>


    </body>
</html>