---
layout: post
title: '优化你的css'
time: 2014-07-31
site_name: mweb.baidu.com
source_url: http://mweb.baidu.com/p/%e4%bc%98%e5%8c%96%e4%bd%a0%e7%9a%84css.html
---
{% raw %}

		<blockquote><p>
  优化你的css，是优化你的xxx系列的第一篇，后续会推出多篇，欢迎大家来关注<a href="http://weibo.com/mbuweb">移动云前端小组</a>获取最新文章。
</p></blockquote>
<h2>系列概述</h2>
<blockquote>
<p>
  在移动web兴起的年代，速度优化重新被大家重视起来，因为手机的网络环境和性能比PC端差了很多，估计大家也能感觉到用手机打开网页的时候，能明显感觉到页面蜗牛般的速度。</p>
<p>  这个系列的优化会以移动环境为基础，当然绝大多数规则也同样适合PC端。
</p>
</blockquote>
<h2>优化的基本原则</h2>
<blockquote><p>
  速度优化有一些基本思路，提前总结一下
</p></blockquote>
<ul>
<li>按需加载(只加载你需要的)</li>
<li>并行(让串行的事情并行起来)</li>
<li>压缩(通过压缩减少体积)</li>
<li>缓存(利用缓存，减少请求等待)</li>
<li>预测(预测用户行为，提前发出请求)</li>
<li>合并(把多个零散文件合并起来，减少请求)</li>
<li>自动化(让速度优化变成一种常规，和自动化工具(例如gulp,grunt,fis)结合，减少成本)</li>
</ul>
<h2>进入正题，优化你的css</h2>
<blockquote><p>
  为什么第一篇讲css，因为css是最难优化的，图片和js你都可以延迟加载，而css不可以，你必须在dom前面加载css，你必须接受css阻塞dom渲染的现实。
</p></blockquote>
<h2>css优化之压缩(cssshrink)</h2>
<blockquote><p>
  我们一般都会对css进行常规压缩，主要做去空格和换行的工作。这里推荐的cssshrink会做更精细的工作，cssshrink会首先通过css parser对css进行解析，然后有针对性的进行优化。例如会吧0px和0%转换成0，bold转换成700，字符级别的极致压缩，为作者点个赞。
</p></blockquote>
<ul>
<li>cssshrink具体的优化策略，<a href="http://cssshrink.com/velocity">点此查看</a>
</li>
<li>cssshrink <a href="https://github.com/stoyan/cssshrink">GitHub地址</a>
</li>
</ul>
<h2>css优化之合并</h2>
<ul>
<li>使用gulp-concat将多个css合并在一起</li>
<li>不要使用@import 减少阻塞和请求</li>
</ul>
<h2>css拆分</h2>
<blockquote>
<p>
  看起来和上面有些冲突，这也是css和其它部分优化不同的地方。 一般我们大家都习惯把css放在最上面，js放在最下面。这是一个好习惯，但是对于css来说并不是最好的选择。</p>
<p>  在移动端，大家非常重视首屏时间，也就是用户看到页面的时间。把整个页面的css都放在最上面，大量首屏用不到的css会阻塞首屏的展现。
</p>
</blockquote>
<ul>
<li>head只放首屏能用到的css，首屏外的css下移</li>
</ul>
<h2>css使用率</h2>
<blockquote><p>
  一般页面经过多人维护后，会产生大量用不到css，大家也不敢随意删除，这就需要一些检测工具
</p></blockquote>
<ol>
<li>
<a href="https://github.com/demohi/unu">unu</a><br>
1.1 unu是一个用来检测页面哪些css没有用到的Node.js模块<br>
1.2 优点：提供<a href="https://github.com/demohi/unu-web">可视化界面</a>,使用非常简单，输入url，即可查看页面css的使用情况<br>
1.3 缺点：目前只支持style标签式的css，另外没有执行页面的js</li>
<li>
<a href="https://github.com/giakki/uncss">uncss</a><br>
2.1 uncss是可以把页面css没有用到去除的模块<br>
2.2 优点：支持命令行和gulp、grunt插件，支持link方式，基于phantomjs，模拟浏览器执行，支持js执行<br>
2.3 缺点：仅凭一个url导出的css，不具有实际价值，另外不支持style标签</li>
<li>
<a href="https://github.com/addyosmani/critical">critical</a><br>
3.1 critical是一个用来检测首屏css有哪些没用到的模块<br>
3.2优点：可以输入首屏宽高来检测、有gulp、grunt插件<br>
3.3 缺点：不支持url，只支持本地html，不支持style标签</li>
</ol>
<h2>总结</h2>
<blockquote><p>
  速度优化对于开发人员来说是件降低生产力的事情，所以需要尽可能的自动化，设置好规则，无痛优化，同时避免后续恶化。
</p></blockquote>
<p>有任何问题，欢迎</p>
			<!-- .entry-content -->
{% endraw %}
