---
layout: post
title: 'The Benchmark Paradox'
time: 2014-05-03 00:00:00 +0800
site_name: brendangregg.com
source_url: http://www.brendangregg.com/blog/2014-05-03/the-benchmark-paradox.html
images:
  7a9d5317198fa88c98434624fabae66c: /blog/images/2014/coin01red_400.jpg
---
{% raw %}

<div style="float:right;padding:10px;padding-top:0px"><img border="0" src="/images/brendangregg.com/7a9d5317198fa88c98434624fabae66c.jpg" width="200"></div>

<p>Benchmarks are often used for product evaluations, and they are often so inaccurate one may as well flip a coin. But it's even worse than that.</p>

<blockquote>If your product's chances of winning a benchmark are 50/50, you'll usually lose.</blockquote>

<p>This seeming paradox can be explained by some simple probability...</p>

<p>Most of the benchmarks I've debugged were false or misleading for one reason or another. 
A long time ago I was explaining this to a sales person, whose prospects used benchmarks to evaluate his product, and he asked:</p>

<ul>
"But it could be wrong either way, like a coin toss?"<br>
"Yes."<br>
"That gives me a 50/50 chance of winning!"
</ul>

<p>He was delighted. His logic was that if the benchmarks were usually wrong – producing random numbers for his product and his competitor's – then at least half the time they should be wrong but in his favor. If he won half the benchmarks, he'd have great growth.</p>

<p>I was annoyed: his product <em>did</em> perform well, and he should have been winning more than 90%, not 50%.
Reality was even worse: he didn't win 90%, or even 50%. It didn't make sense until I debugged some cases.</p>

<p>When buying a product based on performance, customers often want to be <em>really</em> sure it delivers. That can mean not running one benchmark, but several, and wanting the product to <em>win them all</em>.</p>

<p>One customer, who used a set of three benchmarks, found the product won two but lost the third. They'd only be happy if it won them all. Their technique was problematic, as is often the case, and basically became a coin toss. For each benchmark.</p>

<blockquote>Probability of winning all three benchmarks = 0.5 x 0.5 x 0.5 = 0.125 = 12.5%</blockquote>

<p>The more benchmarks – with the requirement of winning them all – the worse the chances. And as I mentioned in my previous post about <a href="http://www.brendangregg.com/blog/2014-05-02/compilers-love-messing-with-benchmarks.html">compilers and benchmarks</a>, kitchen-sink benchmarks are now popular.</p>

<p>This failure mode wasn't always the case for the unlucky sales person, but it did happen at least a few times, and probably more that he didn't know of. This is a problem for anyone promising high performance, where a single poor result can cast doubt on their claims. And when multiple benchmarks are conducted incorrectly, the chances of flipping tails becomes high.</p>

<p>Benchmark gambling is a sucker's game: play <a href="http://www.brendangregg.com/activebenchmarking.html">active benchmarking</a> instead.</p>

{% endraw %}
