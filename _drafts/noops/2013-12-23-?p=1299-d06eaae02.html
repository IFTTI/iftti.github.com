---
layout: post
title: multitail 监控多个文件或命令
time: 2013-12-23 06:05:00 +0800
site_name: noops.me
source_url: http://noops.me/?p=1299
---

                <p>之前有同事希望在终端下开多个窗口查看服务状态，后来用xterm解决。<br>
multitail可以很好的实现该功能，示例如下：<br>
<code>multitail  --label "baidu.com: " -l 'ping baidu.com' --label "sina.com: " -l 'ping sina.com' --label "taobao.com: " -l "ping taobao.com" --label "sohu.com: " -l "ping sohu.com" --label "syslog: " /var/log/syslog -l "vmstat 1" -sw 100,100 -sn 3,3</code></p>
<p>-sw 用来设置有多少列，每列的大小<br>
-sn 配合-sw/-s使用，设置每列的窗口数<br>
-C  放在multitail后面，输出颜色</p>
<p><a href="http://noops.me/wp-content/uploads/2013/12/%E9%80%89%E5%8C%BA_007.png"><img src="http://noops.me/wp-content/uploads/2013/12/%E9%80%89%E5%8C%BA_007-1024x640.png" alt="选区_007" width="1024" height="640" class="aligncenter size-large wp-image-1301"></a><br>
进入后，按h帮助，大写O清屏，更多功能大家自己发掘把，比如：只显示差异</p>
<p>安装使用yum或者apt, <code>apt-get install multitail</code><br>
更多例子：<br>
<span id="more-1299"></span></p>
<p></p>
<!-- Crayon Syntax Highlighter v2.1.2 -->

		<div id="crayon-53c3c1cdb85e2" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="height: 18px !important; line-height: 18px !important;">
<span class="crayon-title"></span>
			<div class="crayon-tools">
<div class="crayon-button crayon-nums-button" title="切换显示行编号"></div>
<div class="crayon-button crayon-plain-button" title="纯文本显示代码"></div>
<div class="crayon-button crayon-wrap-button" title="切换自动换行"></div>
<div class="crayon-button crayon-expand-button" title="Expand Code"></div>
<div class="crayon-button crayon-copy-button" title="Expand Code"></div>
<div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"></div>
</div>
</div>
			<div class="crayon-info" style="min-height: 15px !important; line-height: 15px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
    Merge 2 logfiles in one window:

    multitail /var/log/apache/access.log -I /var/log/apache/error.log

    Show 3 logfiles in 2 columns:

    multitail -s 2 /var/log/apache/access.log /var/log/messages /var/log/mail.log

    Show 5 logfiles while merging 2 and put them in 2 columns with only one in the left column:

    multitail -s 2 -sn 1,3  /var/log/apache/access.log -I /var/log/apache/error.log /var/log/messages \
                            /var/log/mail.log /var/log/syslog

    Merge the output of 2 ping commands while removing "64 bytes received from" from only 1 of them:

    multitail -l "ping 192.168.0.1" -ke "64 bytes from" -L "ping 192.168.0.2"

    Show the output of a ping-command and if it displays a timeout, send a message to all users
    currently logged in

    multitail -ex timeout "echo timeout | wall" -l "ping 192.168.0.1"

    In one window show all new TCP connections and their state changes using netstat while in
    the other window displaying the merged access and error logfiles of apache

    multitail -R 2 -l "netstat -t" /var/log/apache/access.log -I /var/log/apache/error.log

    As the previosu example but also copy the output to the file netstat.log

    multitail -a netstat.log -R 2 -l "netstat -t tcp" /var/log/apache/access.log -I /var/log/apache/error.log

    Show 2 logfiles merged in one window but give each logfile a different color so that you
    can easily see what lines are for what logfile:

    multitail -ci green /var/log/apache/access.log -ci red -I /var/log/apache/error.log

    Show 3 rssfeeds merged in one window using rsstail

    multitail -cS rsstail -l "rsstail -n 1 -z -l -d -u http://setiathome.berkeley.edu/rss_main.php" \
        -cS rsstail -L "rsstail -n 1 -z -l -d -u http://www.biglumber.com/index.rss" -cS rsstail \
        -L "rsstail -n 1 -z -l -u http://kernel.org/kdist/rss.xml"

    Show a Squid (proxy server) logfile while converting timestamps to something readable

    multitail -cv squid /var/log/squid/access.log

    Display Q-Mail logging while converting the timestamp into human readable format

    multitail -cv qmailtimestr /var/log/qmail/qmail.smtpd.log

    Merge ALL apache logfiles (*access_log/*error_log) into one window:

    multitail -cS apache --mergeall /var/log/apache/*access_log --no-mergeall -cS apache_error \
        --mergeall /var/log/apache/*error_log --no-mergeall

    Monitor the logfile of an other system:
    For this you need to setup a couple of things. MultiTail runs on system A, the logfile on system B.
    In this example we're going to monitor the apache logfile. Add the following to /etc/services:

    apachelog       20000/tcp

    Add this to /etc/inetd.conf:

    apachelog stream tcp nowait root /usr/local/sbin/tail_apache_log /usr/local/sbin/tail_apache_log

    and create the file /usr/local/sbin/tail_apache_log with the following content:

    #!/bin/sh

    /usr/bin/tail -f /var/log/apache2/access.log

    make sure that you don't forget to make that script executable (chmod +x filename).
    Then on host A start MultiTail like this:

    multitail -cS apache -l "telnet B 20000"

    Please note that logfiles go in plaintext across the network. You may also need to adjust
    the files /etc/hosts.[allow|deny] on host B to only allow host A to connect.
    Monitoring Tomcat

    multitail -cS apache -cS log4j "${TOMCAT_HOME}/logs/catalina.out"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-1">1</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-2">2</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-3">3</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-4">4</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-5">5</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-6">6</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-7">7</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-8">8</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-9">9</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-10">10</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-11">11</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-12">12</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-13">13</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-14">14</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-15">15</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-16">16</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-17">17</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-18">18</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-19">19</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-20">20</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-21">21</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-22">22</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-23">23</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-24">24</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-25">25</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-26">26</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-27">27</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-28">28</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-29">29</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-30">30</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-31">31</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-32">32</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-33">33</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-34">34</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-35">35</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-36">36</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-37">37</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-38">38</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-39">39</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-40">40</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-41">41</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-42">42</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-43">43</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-44">44</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-45">45</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-46">46</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-47">47</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-48">48</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-49">49</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-50">50</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-51">51</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-52">52</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-53">53</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-54">54</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-55">55</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-56">56</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-57">57</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-58">58</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-59">59</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-60">60</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-61">61</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-62">62</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-63">63</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-64">64</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-65">65</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-66">66</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-67">67</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-68">68</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-69">69</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-70">70</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-71">71</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-72">72</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-73">73</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-74">74</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-75">75</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-76">76</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-77">77</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-78">78</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-79">79</div>
<div class="crayon-num crayon-striped-num" data-line="crayon-53c3c1cdb85e2-80">80</div>
<div class="crayon-num" data-line="crayon-53c3c1cdb85e2-81">81</div>
</div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-line" id="crayon-53c3c1cdb85e2-1">
<span class="h">    </span><span class="i">Merge</span><span class="h"> </span><span class="cn">2</span><span class="h"> </span><span class="e">logfiles </span><span class="st">in</span><span class="h"> </span><span class="e">one </span><span class="i">window</span><span class="o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-2"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-3">
<span class="h">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">access</span><span class="sy">.</span><span class="v">log</span><span class="h"> </span><span class="o">-</span><span class="i">I</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">error</span><span class="sy">.</span><span class="e">log</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-4"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-5">
<span class="e">    </span><span class="i">Show</span><span class="h"> </span><span class="cn">3</span><span class="h"> </span><span class="e">logfiles </span><span class="st">in</span><span class="h"> </span><span class="cn">2</span><span class="h"> </span><span class="i">columns</span><span class="o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-6"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-7">
<span class="h">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="i">s</span><span class="h"> </span><span class="cn">2</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">access</span><span class="sy">.</span><span class="v">log</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">messages</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">mail</span><span class="sy">.</span><span class="e">log</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-8"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-9">
<span class="e">    </span><span class="i">Show</span><span class="h"> </span><span class="cn">5</span><span class="h"> </span><span class="e">logfiles </span><span class="st">while</span><span class="h"> </span><span class="i">merging</span><span class="h"> </span><span class="cn">2</span><span class="h"> </span><span class="st">and</span><span class="h"> </span><span class="e">put </span><span class="e">them </span><span class="st">in</span><span class="h"> </span><span class="cn">2</span><span class="h"> </span><span class="e">columns </span><span class="e">with </span><span class="e">only </span><span class="e">one </span><span class="st">in</span><span class="h"> </span><span class="e">the </span><span class="e">left </span><span class="i">column</span><span class="o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-10"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-11">
<span class="h">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="i">s</span><span class="h"> </span><span class="cn">2</span><span class="h"> </span><span class="o">-</span><span class="i">sn</span><span class="h"> </span><span class="cn">1</span><span class="sy">,</span><span class="cn">3</span><span class="h">  </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">access</span><span class="sy">.</span><span class="v">log</span><span class="h"> </span><span class="o">-</span><span class="i">I</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">error</span><span class="sy">.</span><span class="v">log</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">messages</span><span class="h"> </span><span class="sy">\</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-12">
<span class="h">                            </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">mail</span><span class="sy">.</span><span class="v">log</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="e">syslog</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-13"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-14">
<span class="e">    </span><span class="e">Merge </span><span class="e">the </span><span class="e">output </span><span class="i">of</span><span class="h"> </span><span class="cn">2</span><span class="h"> </span><span class="e">ping </span><span class="e">commands </span><span class="st">while</span><span class="h"> </span><span class="i">removing</span><span class="h"> </span><span class="s">"64 bytes received from"</span><span class="h"> </span><span class="e">from </span><span class="i">only</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="e">of </span><span class="i">them</span><span class="o">:</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-15"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-16">
<span class="h">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="i">l</span><span class="h"> </span><span class="s">"ping 192.168.0.1"</span><span class="h"> </span><span class="o">-</span><span class="i">ke</span><span class="h"> </span><span class="s">"64 bytes from"</span><span class="h"> </span><span class="o">-</span><span class="i">L</span><span class="h"> </span><span class="s">"ping 192.168.0.2"</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-17"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-18">
<span class="h">    </span><span class="e">Show </span><span class="e">the </span><span class="e">output </span><span class="i">of</span><span class="h"> </span><span class="i">a</span><span class="h"> </span><span class="i">ping</span><span class="o">-</span><span class="e">command </span><span class="st">and</span><span class="h"> </span><span class="st">if</span><span class="h"> </span><span class="e">it </span><span class="i">displays</span><span class="h"> </span><span class="i">a</span><span class="h"> </span><span class="i">timeout</span><span class="sy">,</span><span class="h"> </span><span class="i">send</span><span class="h"> </span><span class="i">a</span><span class="h"> </span><span class="e">message </span><span class="st">to</span><span class="h"> </span><span class="e">all </span><span class="e">users</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-19">
<span class="e">    </span><span class="e">currently </span><span class="e">logged </span><span class="st">in</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-20"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-21">
<span class="h">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="e">ex </span><span class="i">timeout</span><span class="h"> </span><span class="s">"echo timeout | wall"</span><span class="h"> </span><span class="o">-</span><span class="i">l</span><span class="h"> </span><span class="s">"ping 192.168.0.1"</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-22"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-23">
<span class="h">    </span><span class="st">In</span><span class="h"> </span><span class="e">one </span><span class="e">window </span><span class="e">show </span><span class="e">all </span><span class="r">new</span><span class="h"> </span><span class="e">TCP </span><span class="e">connections </span><span class="st">and</span><span class="h"> </span><span class="e">their </span><span class="e">state </span><span class="e">changes </span><span class="e">using </span><span class="e">netstat </span><span class="st">while</span><span class="h"> </span><span class="st">in</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-24">
<span class="h">    </span><span class="e">the </span><span class="e">other </span><span class="e">window </span><span class="e">displaying </span><span class="e">the </span><span class="e">merged </span><span class="e">access </span><span class="st">and</span><span class="h"> </span><span class="e">error </span><span class="e">logfiles </span><span class="e">of </span><span class="e">apache</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-25"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-26">
<span class="e">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="i">R</span><span class="h"> </span><span class="cn">2</span><span class="h"> </span><span class="o">-</span><span class="i">l</span><span class="h"> </span><span class="s">"netstat -t"</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">access</span><span class="sy">.</span><span class="v">log</span><span class="h"> </span><span class="o">-</span><span class="i">I</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">error</span><span class="sy">.</span><span class="e">log</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-27"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-28">
<span class="e">    </span><span class="st">As</span><span class="h"> </span><span class="e">the </span><span class="e">previosu </span><span class="e">example </span><span class="e">but </span><span class="e">also </span><span class="e">copy </span><span class="e">the </span><span class="e">output </span><span class="st">to</span><span class="h"> </span><span class="e">the </span><span class="e">file </span><span class="i">netstat</span><span class="sy">.</span><span class="e">log</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-29"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-30">
<span class="e">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="i">a</span><span class="h"> </span><span class="i">netstat</span><span class="sy">.</span><span class="v">log</span><span class="h"> </span><span class="o">-</span><span class="i">R</span><span class="h"> </span><span class="cn">2</span><span class="h"> </span><span class="o">-</span><span class="i">l</span><span class="h"> </span><span class="s">"netstat -t tcp"</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">access</span><span class="sy">.</span><span class="v">log</span><span class="h"> </span><span class="o">-</span><span class="i">I</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">error</span><span class="sy">.</span><span class="e">log</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-31"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-32">
<span class="e">    </span><span class="i">Show</span><span class="h"> </span><span class="cn">2</span><span class="h"> </span><span class="e">logfiles </span><span class="e">merged </span><span class="st">in</span><span class="h"> </span><span class="e">one </span><span class="e">window </span><span class="e">but </span><span class="e">give </span><span class="st">each</span><span class="h"> </span><span class="i">logfile</span><span class="h"> </span><span class="i">a</span><span class="h"> </span><span class="e">different </span><span class="e">color </span><span class="e">so </span><span class="e">that </span><span class="e">you</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-33">
<span class="e">    </span><span class="e">can </span><span class="e">easily </span><span class="e">see </span><span class="e">what </span><span class="e">lines </span><span class="e">are </span><span class="st">for</span><span class="h"> </span><span class="e">what </span><span class="i">logfile</span><span class="o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-34"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-35">
<span class="h">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="e">ci </span><span class="i">green</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">access</span><span class="sy">.</span><span class="v">log</span><span class="h"> </span><span class="o">-</span><span class="e">ci </span><span class="i">red</span><span class="h"> </span><span class="o">-</span><span class="i">I</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="i">error</span><span class="sy">.</span><span class="e">log</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-36"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-37">
<span class="e">    </span><span class="i">Show</span><span class="h"> </span><span class="cn">3</span><span class="h"> </span><span class="e">rssfeeds </span><span class="e">merged </span><span class="st">in</span><span class="h"> </span><span class="e">one </span><span class="e">window </span><span class="e">using </span><span class="e">rsstail</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-38"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-39">
<span class="e">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="e">cS </span><span class="i">rsstail</span><span class="h"> </span><span class="o">-</span><span class="i">l</span><span class="h"> </span><span class="s">"rsstail -n 1 -z -l -d -u http://setiathome.berkeley.edu/rss_main.php"</span><span class="h"> </span><span class="sy">\</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-40">
<span class="h">        </span><span class="o">-</span><span class="e">cS </span><span class="i">rsstail</span><span class="h"> </span><span class="o">-</span><span class="i">L</span><span class="h"> </span><span class="s">"rsstail -n 1 -z -l -d -u http://www.biglumber.com/index.rss"</span><span class="h"> </span><span class="o">-</span><span class="e">cS </span><span class="i">rsstail</span><span class="h"> </span><span class="sy">\</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-41">
<span class="h">        </span><span class="o">-</span><span class="i">L</span><span class="h"> </span><span class="s">"rsstail -n 1 -z -l -u http://kernel.org/kdist/rss.xml"</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-42"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-43">
<span class="h">    </span><span class="i">Show</span><span class="h"> </span><span class="i">a</span><span class="h"> </span><span class="e">Squid</span><span class="h"> </span><span class="sy">(</span><span class="e">proxy </span><span class="i">server</span><span class="sy">)</span><span class="h"> </span><span class="e">logfile </span><span class="st">while</span><span class="h"> </span><span class="e">converting </span><span class="e">timestamps </span><span class="st">to</span><span class="h"> </span><span class="e">something </span><span class="e">readable</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-44"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-45">
<span class="e">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="e">cv </span><span class="i">squid</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">squid</span><span class="o">/</span><span class="i">access</span><span class="sy">.</span><span class="e">log</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-46"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-47">
<span class="e">    </span><span class="i">Display</span><span class="h"> </span><span class="i">Q</span><span class="o">-</span><span class="e">Mail </span><span class="e">logging </span><span class="st">while</span><span class="h"> </span><span class="e">converting </span><span class="e">the </span><span class="e">timestamp </span><span class="e">into </span><span class="e">human </span><span class="e">readable </span><span class="e">format</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-48"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-49">
<span class="e">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="e">cv </span><span class="i">qmailtimestr</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">qmail</span><span class="o">/</span><span class="i">qmail</span><span class="sy">.</span><span class="v">smtpd</span><span class="sy">.</span><span class="e">log</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-50"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-51">
<span class="e">    </span><span class="e">Merge </span><span class="e">ALL </span><span class="e">apache </span><span class="e">logfiles</span><span class="h"> </span><span class="sy">(</span><span class="o">*</span><span class="i">access_log</span><span class="o">/</span><span class="o">*</span><span class="i">error_log</span><span class="sy">)</span><span class="h"> </span><span class="e">into </span><span class="e">one </span><span class="i">window</span><span class="o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-52"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-53">
<span class="h">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="e">cS </span><span class="i">apache</span><span class="h"> </span><span class="o">--</span><span class="i">mergeall</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="o">*</span><span class="i">access_log</span><span class="h"> </span><span class="o">--</span><span class="i">no</span><span class="o">-</span><span class="i">mergeall</span><span class="h"> </span><span class="o">-</span><span class="e">cS </span><span class="i">apache_error</span><span class="h"> </span><span class="sy">\</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-54">
<span class="h">        </span><span class="o">--</span><span class="i">mergeall</span><span class="h"> </span><span class="o">/</span><span class="t">var</span><span class="o">/</span><span class="i">log</span><span class="o">/</span><span class="i">apache</span><span class="o">/</span><span class="o">*</span><span class="i">error_log</span><span class="h"> </span><span class="o">--</span><span class="i">no</span><span class="o">-</span><span class="e">mergeall</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-55"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-56">
<span class="e">    </span><span class="e">Monitor </span><span class="e">the </span><span class="e">logfile </span><span class="e">of </span><span class="e">an </span><span class="e">other </span><span class="i">system</span><span class="o">:</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-57">
<span class="h">    </span><span class="st">For</span><span class="h"> </span><span class="r">this</span><span class="h"> </span><span class="e">you </span><span class="e">need </span><span class="st">to</span><span class="h"> </span><span class="i">setup</span><span class="h"> </span><span class="i">a</span><span class="h"> </span><span class="e">couple </span><span class="e">of </span><span class="i">things</span><span class="sy">.</span><span class="h"> </span><span class="e">MultiTail </span><span class="e">runs </span><span class="e">on </span><span class="i">system</span><span class="h"> </span><span class="i">A</span><span class="sy">,</span><span class="h"> </span><span class="e">the </span><span class="e">logfile </span><span class="e">on </span><span class="i">system</span><span class="h"> </span><span class="i">B</span><span class="sy">.</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-58">
<span class="h">    </span><span class="st">In</span><span class="h"> </span><span class="r">this</span><span class="h"> </span><span class="e">example </span><span class="i">we</span><span class="s">'re going to monitor the apache logfile. Add the following to /etc/services:</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-59"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-60"><span class="s">    apachelog       20000/tcp</span></div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-61"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-62"><span class="s">    Add this to /etc/inetd.conf:</span></div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-63"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-64"><span class="s">    apachelog stream tcp nowait root /usr/local/sbin/tail_apache_log /usr/local/sbin/tail_apache_log</span></div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-65"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-66"><span class="s">    and create the file /usr/local/sbin/tail_apache_log with the following content:</span></div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-67"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-68"><span class="s">    #!/bin/sh</span></div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-69"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-70"><span class="s">    /usr/bin/tail -f /var/log/apache2/access.log</span></div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-71"> </div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-72">
<span class="s">    make sure that you don'</span><span class="i">t</span><span class="h"> </span><span class="e">forget </span><span class="st">to</span><span class="h"> </span><span class="e">make </span><span class="e">that </span><span class="e">script </span><span class="e">executable</span><span class="h"> </span><span class="sy">(</span><span class="i">chmod</span><span class="h"> </span><span class="o">+</span><span class="i">x</span><span class="h"> </span><span class="i">filename</span><span class="sy">)</span><span class="sy">.</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-73">
<span class="h">    </span><span class="st">Then</span><span class="h"> </span><span class="e">on </span><span class="i">host</span><span class="h"> </span><span class="i">A</span><span class="h"> </span><span class="e">start </span><span class="e">MultiTail </span><span class="e">like </span><span class="r">this</span><span class="o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-74"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-75">
<span class="h">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="e">cS </span><span class="i">apache</span><span class="h"> </span><span class="o">-</span><span class="i">l</span><span class="h"> </span><span class="s">"telnet B 20000"</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-76"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-77">
<span class="h">    </span><span class="e">Please </span><span class="e">note </span><span class="e">that </span><span class="e">logfiles </span><span class="e">go </span><span class="st">in</span><span class="h"> </span><span class="e">plaintext </span><span class="e">across </span><span class="e">the </span><span class="i">network</span><span class="sy">.</span><span class="h"> </span><span class="e">You </span><span class="e">may </span><span class="e">also </span><span class="e">need </span><span class="st">to</span><span class="h"> </span><span class="e">adjust</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-78">
<span class="e">    </span><span class="e">the </span><span class="i">files</span><span class="h"> </span><span class="o">/</span><span class="i">etc</span><span class="o">/</span><span class="i">hosts</span><span class="sy">.</span><span class="sy">[</span><span class="i">allow</span><span class="o">|</span><span class="i">deny</span><span class="sy">]</span><span class="h"> </span><span class="e">on </span><span class="i">host</span><span class="h"> </span><span class="i">B</span><span class="h"> </span><span class="st">to</span><span class="h"> </span><span class="e">only </span><span class="e">allow </span><span class="i">host</span><span class="h"> </span><span class="i">A</span><span class="h"> </span><span class="st">to</span><span class="h"> </span><span class="i">connect</span><span class="sy">.</span>
</div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-79">
<span class="h">    </span><span class="e">Monitoring </span><span class="e">Tomcat</span>
</div>
<div class="crayon-line crayon-striped-line" id="crayon-53c3c1cdb85e2-80"> </div>
<div class="crayon-line" id="crayon-53c3c1cdb85e2-81">
<span class="e">    </span><span class="i">multitail</span><span class="h"> </span><span class="o">-</span><span class="e">cS </span><span class="i">apache</span><span class="h"> </span><span class="o">-</span><span class="e">cS </span><span class="i">log4j</span><span class="h"> </span><span class="s">"${TOMCAT_HOME}/logs/catalina.out"</span>
</div>
</div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0268 seconds] -->
<p></p>
            
